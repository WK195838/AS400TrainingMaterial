# Á¨¨ÂçÅÈÄ±ÔºöÊïàËÉΩÂÑ™Âåñ - ÂÆåÊï¥ÊïôÊùê

## üìö Êú¨ÈÄ±Â≠∏ÁøíÁõÆÊ®ô

ÂÆåÊàêÊú¨ÈÄ±Â≠∏ÁøíÂæåÔºåÂ≠∏Âì°Â∞áËÉΩÂ§†Ôºö
- ÁêÜËß£AS/400Á≥ªÁµ±ÊïàËÉΩÂàÜÊûêÁöÑÊñπÊ≥ïÂíåÂ∑•ÂÖ∑
- ÊéåÊè°Á®ãÂºèÁ¢ºÂ±§Á¥öÁöÑÊïàËÉΩÂÑ™ÂåñÊäÄË°ì
- ÁÜüÁ∑¥‰ΩøÁî®Á≥ªÁµ±Áõ£ÊéßÂ∑•ÂÖ∑ÈÄ≤Ë°åÊïàËÉΩË®∫Êñ∑
- Ë®≠Ë®àÈ´òÊïàÁöÑË≥áÊñôÂ≠òÂèñÁ≠ñÁï•ÂíåÁ¥¢ÂºïÊ©üÂà∂
- ÂØ¶‰ΩúË®òÊÜ∂È´îÁÆ°ÁêÜÂíåI/OÂÑ™ÂåñÊäÄË°ì
- Âª∫Á´ãÂÆåÊï¥ÁöÑÊïàËÉΩÁõ£ÊéßÂíåË™øÊ†°ÊµÅÁ®ã

---

## üìä Á¨¨‰∏ÄÁØÄÔºöÊïàËÉΩÂàÜÊûêÂü∫Á§é

### 1.1 AS/400ÊïàËÉΩÊû∂Êßã

#### 1.1.1 Á≥ªÁµ±ÊïàËÉΩÂ±§Ê¨°Ê®°Âûã

```
AS/400 ÊïàËÉΩÂàÜÊûêÂ±§Ê¨°Êû∂ÊßãÔºö
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÊáâÁî®Á®ãÂºèÂ±§ (Application Layer)          ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ COBOLÁ®ãÂºèÊïàËÉΩ                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÊºîÁÆóÊ≥ïÊïàÁéá                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ëø¥ÂúàÂÑ™Âåñ                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë®òÊÜ∂È´î‰ΩøÁî®                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÂáΩÊï∏ÂëºÂè´ÈñãÈä∑                     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üï Ë≥áÊñôÂ≠òÂèñ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Ë≥áÊñôÂ≠òÂèñÂ±§ (Data Access Layer)          ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ Ê™îÊ°àÂíåË≥áÊñôÂ∫´Â≠òÂèñ                   ‚îÇ ‚îÇ
‚îÇ ‚îÇ - SQLÊü•Ë©¢ÂÑ™Âåñ                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Á¥¢Âºï‰ΩøÁî®Á≠ñÁï•                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë®òÈåÑÈéñÂÆöÊ©üÂà∂                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë≥áÊñôÁ∑©Â≠òÁÆ°ÁêÜ                     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üï Á≥ªÁµ±ÂëºÂè´
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Á≥ªÁµ±ÊúçÂãôÂ±§ (System Service Layer)      ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ OS/400Á≥ªÁµ±ÊúçÂãô                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ‰ΩúÊ•≠Ë™øÂ∫¶                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë®òÊÜ∂È´îÁÆ°ÁêÜ                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ - I/OËôïÁêÜ                          ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Á∂≤Ë∑ØÈÄöË®ä                         ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üï Á°¨È´îÂ≠òÂèñ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Á°¨È´îË≥áÊ∫êÂ±§ (Hardware Resource Layer)   ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ ÂØ¶È´îÁ°¨È´îË≥áÊ∫ê                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ - CPU‰ΩøÁî®Áéá                        ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë®òÊÜ∂È´îÂÆπÈáè                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Á£ÅÁ¢üI/O                          ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Á∂≤Ë∑ØÈ†ªÂØ¨                         ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 1.1.2 ÊïàËÉΩÊåáÊ®ôÈ´îÁ≥ª

```cobol
      *    AS/400 ÊïàËÉΩÁõ£ÊéßÊåáÊ®ôÂàÜÈ°ûÔºö
      *
      *    1. Á≥ªÁµ±Â±§Á¥öÊåáÊ®ô (System Level Metrics)
      *       - CPUÂà©Áî®ÁéáÂíåÁ≠âÂæÖÊôÇÈñì
      *       - Ë®òÊÜ∂È´î‰ΩøÁî®ÁéáÂíåÂàÜÈ†ÅÊ¥ªÂãï
      *       - Á£ÅÁ¢üI/OÈ†ªÁéáÂíåÂõûÊáâÊôÇÈñì
      *       - Á∂≤Ë∑ØÊµÅÈáèÂíåÂª∂ÈÅ≤
      *
      *    2. ÊáâÁî®Â±§Á¥öÊåáÊ®ô (Application Level Metrics)
      *       - Á®ãÂºèÂü∑Ë°åÊôÇÈñì
      *       - Ë≥áÊñôÂ∫´Êü•Ë©¢ÊïàËÉΩ
      *       - ‰∫§ÊòìËôïÁêÜÈáè
      *       - ‰ΩøÁî®ËÄÖÂõûÊáâÊôÇÈñì
      *
      *    3. Ë≥áÊ∫ê‰ΩøÁî®ÊåáÊ®ô (Resource Usage Metrics)
      *       - Ê™îÊ°àÂ≠òÂèñÊ¨°Êï∏
      *       - Ë®òÈåÑÈéñÂÆöÁµ±Ë®à
      *       - Âø´ÂèñÂëΩ‰∏≠Áéá
      *       - ‰ΩµÁôº‰ΩøÁî®ËÄÖÊï∏Èáè
      *
      *    4. ÂïÜÊ•≠ÊïàËÉΩÊåáÊ®ô (Business Performance Metrics)
      *       - ‰∫§ÊòìÂÆåÊàêÁéá
      *       - Á≥ªÁµ±ÂèØÁî®ÊÄß
      *       - ÊúçÂãôÂìÅË≥™Á≠âÁ¥ö
      *       - ‰ΩøÁî®ËÄÖÊªøÊÑèÂ∫¶
```

### 1.2 ÊïàËÉΩÂàÜÊûêÂ∑•ÂÖ∑

#### 1.2.1 Á≥ªÁµ±Áõ£ÊéßÁ®ãÂºè

```cobol
      *****************************************************************
      * Á®ãÂºèÂêçÁ®±ÔºöPERFMON                                            *
      * Á®ãÂºèÂäüËÉΩÔºöÁ≥ªÁµ±ÊïàËÉΩÁõ£ÊéßÁ®ãÂºè                                   *
      * ‰ΩúËÄÖÔºöÊïàËÉΩË™øÊ†°Â∞àÂÆ∂                                           *
      * Êó•ÊúüÔºö2024/02/15                                             *
      *****************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PERFMON.
       
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       
      *    Á≥ªÁµ±Ë≥áË®äÁµêÊßã
       01  WS-SYSTEM-INFO.
           05  WS-SYS-NAME         PIC X(8).
           05  WS-SYS-TYPE         PIC X(4).
           05  WS-SYS-MODEL        PIC X(4).
           05  WS-CPU-COUNT        PIC 9(3).
           05  WS-MEMORY-SIZE      PIC 9(8) COMP.
           
      *    ÊïàËÉΩÁµ±Ë®àË≥áÊñô
       01  WS-PERFORMANCE-STATS.
           05  WS-CPU-UTILIZATION.
               10  WS-CPU-TOTAL    PIC 9(3)V99.
               10  WS-CPU-USER     PIC 9(3)V99.
               10  WS-CPU-SYSTEM   PIC 9(3)V99.
               10  WS-CPU-WAIT     PIC 9(3)V99.
               10  WS-CPU-IDLE     PIC 9(3)V99.
               
           05  WS-MEMORY-USAGE.
               10  WS-MEM-TOTAL    PIC 9(10) COMP.
               10  WS-MEM-USED     PIC 9(10) COMP.
               10  WS-MEM-FREE     PIC 9(10) COMP.
               10  WS-MEM-PERCENT  PIC 9(3)V99.
               
           05  WS-DISK-ACTIVITY.
               10  WS-DISK-READS   PIC 9(10) COMP.
               10  WS-DISK-WRITES  PIC 9(10) COMP.
               10  WS-DISK-READ-TIME PIC 9(8)V99 COMP.
               10  WS-DISK-WRITE-TIME PIC 9(8)V99 COMP.
               
           05  WS-JOB-STATISTICS.
               10  WS-ACTIVE-JOBS  PIC 9(5).
               10  WS-WAITING-JOBS PIC 9(5).
               10  WS-TOTAL-JOBS   PIC 9(5).
               
      *    Áõ£ÊéßÂèÉÊï∏
       01  WS-MONITOR-CONTROL.
           05  WS-MONITOR-INTERVAL PIC 9(3) VALUE 60.
           05  WS-MONITOR-DURATION PIC 9(5) VALUE 3600.
           05  WS-SAMPLE-COUNT     PIC 9(5) VALUE 0.
           05  WS-CONTINUE-MONITOR PIC X.
               88  CONTINUE-MONITORING     VALUE 'Y'.
               88  STOP-MONITORING         VALUE 'N'.
               
      *    Â†±ÂëäÊéßÂà∂
       01  WS-REPORT-CONTROL.
           05  WS-REPORT-FILE      PIC X(21) VALUE '/tmp/perfmon.rpt'.
           05  WS-TIMESTAMP        PIC X(26).
           
       PROCEDURE DIVISION.
       
       MAIN-LOGIC.
           PERFORM INITIALIZE-MONITORING
           PERFORM COLLECT-BASELINE
           PERFORM CONTINUOUS-MONITORING
           PERFORM GENERATE-REPORT.
           STOP RUN.
           
       INITIALIZE-MONITORING.
           DISPLAY 'Initializing Performance Monitoring...'.
           
           PERFORM GET-SYSTEM-INFORMATION.
           PERFORM SETUP-MONITORING-PARAMETERS.
           
           SET CONTINUE-MONITORING TO TRUE.
           MOVE 0 TO WS-SAMPLE-COUNT.
           
           DISPLAY 'System: ' WS-SYS-NAME ' Model: ' WS-SYS-MODEL.
           DISPLAY 'CPUs: ' WS-CPU-COUNT ' Memory: ' WS-MEMORY-SIZE ' MB'.
           DISPLAY 'Monitor interval: ' WS-MONITOR-INTERVAL ' seconds'.
           
       GET-SYSTEM-INFORMATION.
      *    ‰ΩøÁî®Á≥ªÁµ±APIÂèñÂæóÁ°¨È´îË≥áË®ä
           CALL 'QSZRTVPR' USING
               'SYSNAME'
               WS-SYS-NAME.
               
           CALL 'QSZRTVPR' USING
               'QMODEL'
               WS-SYS-MODEL.
               
           CALL 'QSZRTVPR' USING
               'QPRCFEAT'
               WS-CPU-COUNT.
               
           CALL 'QSZRTVPR' USING
               'QSTGLMT'
               WS-MEMORY-SIZE.
               
       SETUP-MONITORING-PARAMETERS.
      *    ÂèØ‰ª•ÂæûÂèÉÊï∏Ê™îÊ°àÊàñ‰ΩøÁî®ËÄÖËº∏ÂÖ•Ë®≠ÂÆöÁõ£ÊéßÂèÉÊï∏
           DISPLAY 'Monitor interval (seconds): '.
           ACCEPT WS-MONITOR-INTERVAL.
           
           DISPLAY 'Monitor duration (seconds): '.
           ACCEPT WS-MONITOR-DURATION.
           
       COLLECT-BASELINE.
           DISPLAY 'Collecting baseline performance data...'.
           
           PERFORM GET-CURRENT-STATS.
           
           DISPLAY 'Baseline collected:'.
           DISPLAY '  CPU Usage: ' WS-CPU-TOTAL '%'.
           DISPLAY '  Memory Usage: ' WS-MEM-PERCENT '%'.
           DISPLAY '  Active Jobs: ' WS-ACTIVE-JOBS.
           
       CONTINUOUS-MONITORING.
           DISPLAY 'Starting continuous monitoring...'.
           
           PERFORM UNTIL STOP-MONITORING
               PERFORM GET-CURRENT-STATS
               PERFORM ANALYZE-PERFORMANCE
               PERFORM LOG-STATISTICS
               
               ADD 1 TO WS-SAMPLE-COUNT
               
               IF WS-SAMPLE-COUNT * WS-MONITOR-INTERVAL >= WS-MONITOR-DURATION
                   SET STOP-MONITORING TO TRUE
               ELSE
                   CALL 'QSLEEP' USING WS-MONITOR-INTERVAL * 1000
               END-IF
           END-PERFORM.
           
       GET-CURRENT-STATS.
      *    Êî∂ÈõÜÁï∂ÂâçÁ≥ªÁµ±Áµ±Ë®àË≥áÊñô
           PERFORM GET-CPU-STATISTICS.
           PERFORM GET-MEMORY-STATISTICS.
           PERFORM GET-DISK-STATISTICS.
           PERFORM GET-JOB-STATISTICS.
           
           MOVE FUNCTION CURRENT-DATE TO WS-TIMESTAMP.
           
       GET-CPU-STATISTICS.
      *    ‰ΩøÁî®QSYS2Á≥ªÁµ±ÊúçÂãôÂèñÂæóCPUÁµ±Ë®à
           EXEC SQL
               SELECT 
                   AVERAGE_CPU_UTILIZATION,
                   CURRENT_CPU_CAPACITY,
                   CPU_CONFIGURED,
                   ELAPSED_TIME
               INTO 
                   :WS-CPU-TOTAL,
                   :WS-CPU-USER,
                   :WS-CPU-COUNT,
                   :WS-CPU-WAIT
               FROM QSYS2.SYSTEM_STATUS_INFO
           END-EXEC.
           
           COMPUTE WS-CPU-IDLE = 100 - WS-CPU-TOTAL.
           
       GET-MEMORY-STATISTICS.
      *    ÂèñÂæóË®òÊÜ∂È´î‰ΩøÁî®Áµ±Ë®à
           EXEC SQL
               SELECT 
                   MAIN_STORAGE_SIZE,
                   CURRENT_UNPROTECTED_USED,
                   (CURRENT_UNPROTECTED_USED * 100.0) / MAIN_STORAGE_SIZE
               INTO 
                   :WS-MEM-TOTAL,
                   :WS-MEM-USED,
                   :WS-MEM-PERCENT
               FROM QSYS2.SYSTEM_STATUS_INFO
           END-EXEC.
           
           COMPUTE WS-MEM-FREE = WS-MEM-TOTAL - WS-MEM-USED.
           
       GET-DISK-STATISTICS.
      *    ÂèñÂæóÁ£ÅÁ¢üI/OÁµ±Ë®à
           EXEC SQL
               SELECT 
                   SUM(DISK_READS),
                   SUM(DISK_WRITES),
                   AVG(DISK_READ_TIME),
                   AVG(DISK_WRITE_TIME)
               INTO 
                   :WS-DISK-READS,
                   :WS-DISK-WRITES,
                   :WS-DISK-READ-TIME,
                   :WS-DISK-WRITE-TIME
               FROM QSYS2.DISK_STATUS_INFO
           END-EXEC.
           
       GET-JOB-STATISTICS.
      *    ÂèñÂæó‰ΩúÊ•≠Áµ±Ë®à
           EXEC SQL
               SELECT 
                   COUNT(*) FILTER (WHERE JOB_STATUS = 'ACTIVE'),
                   COUNT(*) FILTER (WHERE JOB_STATUS = 'WAIT'),
                   COUNT(*)
               INTO 
                   :WS-ACTIVE-JOBS,
                   :WS-WAITING-JOBS,
                   :WS-TOTAL-JOBS
               FROM QSYS2.ACTIVE_JOB_INFO
               WHERE JOB_TYPE <> 'SYS'
           END-EXEC.
           
       ANALYZE-PERFORMANCE.
      *    ÂàÜÊûêÊïàËÉΩË∂®Âã¢ÂíåÁï∞Â∏∏
           PERFORM CHECK-CPU-THRESHOLD.
           PERFORM CHECK-MEMORY-THRESHOLD.
           PERFORM CHECK-DISK-THRESHOLD.
           PERFORM CHECK-JOB-THRESHOLD.
           
       CHECK-CPU-THRESHOLD.
           IF WS-CPU-TOTAL > 80
               DISPLAY 'WARNING: High CPU utilization: ' WS-CPU-TOTAL '%'
               PERFORM RECOMMEND-CPU-OPTIMIZATION
           END-IF.
           
           IF WS-CPU-WAIT > 30
               DISPLAY 'WARNING: High CPU wait time: ' WS-CPU-WAIT '%'
               DISPLAY 'Possible I/O bottleneck detected'
           END-IF.
           
       CHECK-MEMORY-THRESHOLD.
           IF WS-MEM-PERCENT > 85
               DISPLAY 'WARNING: High memory usage: ' WS-MEM-PERCENT '%'
               PERFORM RECOMMEND-MEMORY-OPTIMIZATION
           END-IF.
           
       CHECK-DISK-THRESHOLD.
           IF WS-DISK-READ-TIME > 50 OR WS-DISK-WRITE-TIME > 50
               DISPLAY 'WARNING: High disk response time'
               DISPLAY 'Read time: ' WS-DISK-READ-TIME ' ms'
               DISPLAY 'Write time: ' WS-DISK-WRITE-TIME ' ms'
               PERFORM RECOMMEND-DISK-OPTIMIZATION
           END-IF.
           
       CHECK-JOB-THRESHOLD.
           IF WS-WAITING-JOBS > WS-ACTIVE-JOBS
               DISPLAY 'WARNING: More jobs waiting than active'
               DISPLAY 'Active: ' WS-ACTIVE-JOBS ' Waiting: ' WS-WAITING-JOBS
           END-IF.
           
       RECOMMEND-CPU-OPTIMIZATION.
           DISPLAY 'CPU Optimization Recommendations:'.
           DISPLAY '1. Check for runaway jobs'.
           DISPLAY '2. Review program efficiency'.
           DISPLAY '3. Consider CPU upgrade'.
           DISPLAY '4. Implement workload balancing'.
           
       RECOMMEND-MEMORY-OPTIMIZATION.
           DISPLAY 'Memory Optimization Recommendations:'.
           DISPLAY '1. Increase main storage'.
           DISPLAY '2. Optimize program memory usage'.
           DISPLAY '3. Review pool sizes'.
           DISPLAY '4. Consider memory compression'.
           
       RECOMMEND-DISK-OPTIMIZATION.
           DISPLAY 'Disk Optimization Recommendations:'.
           DISPLAY '1. Check disk configuration'.
           DISPLAY '2. Optimize file placement'.
           DISPLAY '3. Review index usage'.
           DISPLAY '4. Consider SSD upgrade'.
           
       LOG-STATISTICS.
      *    Ë®òÈåÑÁµ±Ë®àË≥áÊñôÂà∞Ê™îÊ°à
           STRING 
               WS-TIMESTAMP ','
               WS-CPU-TOTAL ','
               WS-MEM-PERCENT ','
               WS-DISK-READS ','
               WS-DISK-WRITES ','
               WS-ACTIVE-JOBS ','
               WS-WAITING-JOBS
               DELIMITED BY SIZE
               INTO WS-LOG-RECORD.
               
      *    ÂØ´ÂÖ•Ë®òÈåÑÊ™î
           PERFORM WRITE-LOG-RECORD.
           
       WRITE-LOG-RECORD.
      *    ÈÄôË£°ÊáâË©≤ÂØ´ÂÖ•ÂØ¶ÈöõÁöÑË®òÈåÑÊ™î
           DISPLAY 'Sample ' WS-SAMPLE-COUNT ': ' 
                   'CPU=' WS-CPU-TOTAL '% '
                   'MEM=' WS-MEM-PERCENT '% '
                   'JOBS=' WS-ACTIVE-JOBS.
                   
       GENERATE-REPORT.
           DISPLAY ' '.
           DISPLAY '========== Performance Summary =========='.
           DISPLAY 'Monitoring Duration: ' WS-MONITOR-DURATION ' seconds'.
           DISPLAY 'Total Samples: ' WS-SAMPLE-COUNT.
           DISPLAY ' '.
           DISPLAY 'Final Statistics:'.
           DISPLAY '  CPU Utilization: ' WS-CPU-TOTAL '%'.
           DISPLAY '  Memory Usage: ' WS-MEM-PERCENT '%'.
           DISPLAY '  Active Jobs: ' WS-ACTIVE-JOBS.
           DISPLAY '  Disk Reads: ' WS-DISK-READS.
           DISPLAY '  Disk Writes: ' WS-DISK-WRITES.
           DISPLAY '========================================'.
```

---

## ‚ö° Á¨¨‰∫åÁØÄÔºöÁ®ãÂºèÁ¢ºÂÑ™ÂåñÊäÄË°ì

### 2.1 ÊºîÁÆóÊ≥ïÂíåË≥áÊñôÁµêÊßãÂÑ™Âåñ

#### 2.1.1 È´òÊïàÁöÑË≥áÊñôËôïÁêÜÊºîÁÆóÊ≥ï

```cobol
      *****************************************************************
      * Á®ãÂºèÂêçÁ®±ÔºöALGOPT                                             *
      * Á®ãÂºèÂäüËÉΩÔºöÊºîÁÆóÊ≥ïÂÑ™ÂåñÁ§∫ÁØÑ                                     *
      * ‰ΩúËÄÖÔºöÊïàËÉΩÂÑ™ÂåñÂ∞àÂÆ∂                                           *
      * Êó•ÊúüÔºö2024/02/15                                             *
      *****************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ALGOPT.
       
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       
      *    Â§ßÈáèË≥áÊñôËôïÁêÜÁµêÊßã
       01  WS-LARGE-DATASET.
           05  WS-RECORD-COUNT     PIC 9(6) VALUE 100000.
           05  WS-EMPLOYEE-TABLE.
               10  WS-EMP-ENTRY OCCURS 100000 TIMES 
                                INDEXED BY WS-EMP-IDX.
                   15  WS-EMP-ID       PIC X(6).
                   15  WS-EMP-NAME     PIC X(30).
                   15  WS-EMP-SALARY   PIC 9(8)V99 COMP-3.
                   15  WS-EMP-DEPT     PIC X(4).
                   15  WS-EMP-ACTIVE   PIC X.
                   
      *    Á¥¢ÂºïÂíåÊü•ÊâæË°®
       01  WS-OPTIMIZATION-STRUCTURES.
           05  WS-SALARY-INDEX OCCURS 100000 TIMES 
                               INDEXED BY WS-SAL-IDX.
               10  WS-SALARY-VALUE     PIC 9(8)V99 COMP-3.
               10  WS-SALARY-EMP-IDX   PIC 9(6) COMP.
               
           05  WS-DEPT-LOOKUP.
               10  WS-DEPT-ENTRY OCCURS 20 TIMES 
                                 INDEXED BY WS-DEPT-IDX.
                   15  WS-DEPT-CODE    PIC X(4).
                   15  WS-DEPT-COUNT   PIC 9(6) COMP.
                   15  WS-DEPT-TOTAL   PIC 9(10)V99 COMP-3.
                   
      *    ÊïàËÉΩÊ∏¨Ë©¶ËÆäÊï∏
       01  WS-PERFORMANCE-TEST.
           05  WS-START-TIME       PIC 9(18) COMP.
           05  WS-END-TIME         PIC 9(18) COMP.
           05  WS-ELAPSED-TIME     PIC 9(10)V99 COMP.
           05  WS-TEST-ITERATIONS  PIC 9(6).
           
      *    ÊØîËºÉÁµêÊûú
       01  WS-COMPARISON-RESULTS.
           05  WS-NAIVE-TIME       PIC 9(8)V99 COMP.
           05  WS-OPTIMIZED-TIME   PIC 9(8)V99 COMP.
           05  WS-IMPROVEMENT      PIC 9(5)V99 COMP.
           
       PROCEDURE DIVISION.
       
       MAIN-LOGIC.
           PERFORM INITIALIZE-TEST-DATA
           PERFORM DEMONSTRATE-SEARCH-OPTIMIZATION
           PERFORM DEMONSTRATE-SORT-OPTIMIZATION
           PERFORM DEMONSTRATE-AGGREGATION-OPTIMIZATION
           PERFORM DEMONSTRATE-MEMORY-OPTIMIZATION.
           STOP RUN.
           
       INITIALIZE-TEST-DATA.
           DISPLAY 'Initializing test data (100,000 records)...'.
           
           PERFORM VARYING WS-EMP-IDX FROM 1 BY 1 
                   UNTIL WS-EMP-IDX > WS-RECORD-COUNT
               
      *        Áî¢ÁîüÊ∏¨Ë©¶Ë≥áÊñô
               STRING 'E' WS-EMP-IDX 
                      DELIMITED BY SIZE 
                      INTO WS-EMP-ID(WS-EMP-IDX)
               
               STRING 'Employee ' WS-EMP-IDX
                      DELIMITED BY SIZE
                      INTO WS-EMP-NAME(WS-EMP-IDX)
                      
               COMPUTE WS-EMP-SALARY(WS-EMP-IDX) = 
                   30000 + (FUNCTION MOD(WS-EMP-IDX, 70000))
                   
               COMPUTE WS-DEPT-CALC = FUNCTION MOD(WS-EMP-IDX, 4) + 1
               EVALUATE WS-DEPT-CALC
                   WHEN 1 MOVE 'IT01' TO WS-EMP-DEPT(WS-EMP-IDX)
                   WHEN 2 MOVE 'HR01' TO WS-EMP-DEPT(WS-EMP-IDX)
                   WHEN 3 MOVE 'FN01' TO WS-EMP-DEPT(WS-EMP-IDX)
                   WHEN 4 MOVE 'SL01' TO WS-EMP-DEPT(WS-EMP-IDX)
               END-EVALUATE
               
               MOVE 'Y' TO WS-EMP-ACTIVE(WS-EMP-IDX)
           END-PERFORM.
           
           DISPLAY 'Test data initialized successfully.'.
           
       DEMONSTRATE-SEARCH-OPTIMIZATION.
           DISPLAY ' '.
           DISPLAY '=== Search Algorithm Optimization ==='.
           
      *    Ê∏¨Ë©¶Á∑öÊÄßÊêúÂ∞ã vs ‰∫åÂàÜÊêúÂ∞ã
           PERFORM TEST-LINEAR-SEARCH.
           PERFORM BUILD-SEARCH-INDEX.
           PERFORM TEST-BINARY-SEARCH.
           PERFORM COMPARE-SEARCH-RESULTS.
           
       TEST-LINEAR-SEARCH.
           DISPLAY 'Testing linear search...'.
           
           MOVE FUNCTION CURRENT-DATE TO WS-START-TIME.
           
           MOVE 1000 TO WS-TEST-ITERATIONS.
           PERFORM WS-TEST-ITERATIONS TIMES
               PERFORM LINEAR-SEARCH-SAMPLE
           END-PERFORM.
           
           MOVE FUNCTION CURRENT-DATE TO WS-END-TIME.
           COMPUTE WS-NAIVE-TIME = WS-END-TIME - WS-START-TIME.
           
           DISPLAY 'Linear search completed in: ' WS-NAIVE-TIME ' ms'.
           
       LINEAR-SEARCH-SAMPLE.
      *    ÊêúÂ∞ãÈö®Ê©üÂì°Â∑•
           COMPUTE WS-SEARCH-TARGET = FUNCTION MOD(FUNCTION RANDOM, WS-RECORD-COUNT) + 1.
           
           PERFORM VARYING WS-EMP-IDX FROM 1 BY 1 
                   UNTIL WS-EMP-IDX > WS-RECORD-COUNT
               IF WS-EMP-SALARY(WS-EMP-IDX) > 80000
                   EXIT PERFORM
               END-IF
           END-PERFORM.
           
       BUILD-SEARCH-INDEX.
           DISPLAY 'Building salary index for binary search...'.
           
      *    Ë§áË£ΩËñ™Ë≥áË≥áÊñôÂà∞Á¥¢ÂºïÈô£Âàó
           PERFORM VARYING WS-EMP-IDX FROM 1 BY 1 
                   UNTIL WS-EMP-IDX > WS-RECORD-COUNT
               MOVE WS-EMP-SALARY(WS-EMP-IDX) TO WS-SALARY-VALUE(WS-EMP-IDX)
               MOVE WS-EMP-IDX TO WS-SALARY-EMP-IDX(WS-EMP-IDX)
           END-PERFORM.
           
      *    ÊéíÂ∫èÁ¥¢ÂºïÈô£ÂàóÔºà‰ΩøÁî®Âø´ÈÄüÊéíÂ∫èÊºîÁÆóÊ≥ïÔºâ
           PERFORM QUICK-SORT-SALARY 
               USING 1 WS-RECORD-COUNT.
               
       QUICK-SORT-SALARY USING WS-LOW WS-HIGH.
      *    Á∞°ÂåñÁöÑÂø´ÈÄüÊéíÂ∫èÂØ¶‰Ωú
           IF WS-LOW < WS-HIGH
               PERFORM PARTITION-SALARY USING WS-LOW WS-HIGH 
                                       RETURNING WS-PIVOT
               PERFORM QUICK-SORT-SALARY USING WS-LOW WS-PIVOT - 1
               PERFORM QUICK-SORT-SALARY USING WS-PIVOT + 1 WS-HIGH
           END-IF.
           
       TEST-BINARY-SEARCH.
           DISPLAY 'Testing binary search...'.
           
           MOVE FUNCTION CURRENT-DATE TO WS-START-TIME.
           
           PERFORM WS-TEST-ITERATIONS TIMES
               PERFORM BINARY-SEARCH-SAMPLE
           END-PERFORM.
           
           MOVE FUNCTION CURRENT-DATE TO WS-END-TIME.
           COMPUTE WS-OPTIMIZED-TIME = WS-END-TIME - WS-START-TIME.
           
           DISPLAY 'Binary search completed in: ' WS-OPTIMIZED-TIME ' ms'.
           
       BINARY-SEARCH-SAMPLE.
      *    ‰ΩøÁî®‰∫åÂàÜÊêúÂ∞ãÊ≥ïÊêúÂ∞ãËñ™Ë≥á > 80000ÁöÑÂì°Â∑•
           MOVE 1 TO WS-LOW.
           MOVE WS-RECORD-COUNT TO WS-HIGH.
           
           PERFORM UNTIL WS-LOW > WS-HIGH
               COMPUTE WS-MID = (WS-LOW + WS-HIGH) / 2
               
               IF WS-SALARY-VALUE(WS-MID) > 80000
                   MOVE WS-MID TO WS-HIGH
                   SUBTRACT 1 FROM WS-HIGH
               ELSE
                   MOVE WS-MID TO WS-LOW
                   ADD 1 TO WS-LOW
               END-IF
           END-PERFORM.
           
       COMPARE-SEARCH-RESULTS.
           COMPUTE WS-IMPROVEMENT = 
               ((WS-NAIVE-TIME - WS-OPTIMIZED-TIME) / WS-NAIVE-TIME) * 100.
               
           DISPLAY 'Search Optimization Results:'.
           DISPLAY '  Linear Search: ' WS-NAIVE-TIME ' ms'.
           DISPLAY '  Binary Search: ' WS-OPTIMIZED-TIME ' ms'.
           DISPLAY '  Improvement: ' WS-IMPROVEMENT '%'.
           
       DEMONSTRATE-SORT-OPTIMIZATION.
           DISPLAY ' '.
           DISPLAY '=== Sort Algorithm Optimization ==='.
           
      *    ÊØîËºÉ‰∏çÂêåÊéíÂ∫èÊºîÁÆóÊ≥ïÁöÑÊïàËÉΩ
           PERFORM TEST-BUBBLE-SORT.
           PERFORM TEST-QUICK-SORT.
           PERFORM COMPARE-SORT-RESULTS.
           
       DEMONSTRATE-AGGREGATION-OPTIMIZATION.
           DISPLAY ' '.
           DISPLAY '=== Aggregation Optimization ==='.
           
      *    ÊØîËºÉÁ∞°ÂñÆÁ¥ØÂä† vs ÊâπÊ¨°ËôïÁêÜ
           PERFORM TEST-SIMPLE-AGGREGATION.
           PERFORM TEST-BATCH-AGGREGATION.
           PERFORM COMPARE-AGGREGATION-RESULTS.
           
       TEST-SIMPLE-AGGREGATION.
           DISPLAY 'Testing simple aggregation...'.
           
           MOVE FUNCTION CURRENT-DATE TO WS-START-TIME.
           
      *    ÈÄê‰∏ÄËôïÁêÜÊØèÁ≠ÜË®òÈåÑ
           MOVE 0 TO WS-TOTAL-SALARY.
           PERFORM VARYING WS-EMP-IDX FROM 1 BY 1 
                   UNTIL WS-EMP-IDX > WS-RECORD-COUNT
               ADD WS-EMP-SALARY(WS-EMP-IDX) TO WS-TOTAL-SALARY
           END-PERFORM.
           
           MOVE FUNCTION CURRENT-DATE TO WS-END-TIME.
           COMPUTE WS-NAIVE-TIME = WS-END-TIME - WS-START-TIME.
           
           DISPLAY 'Simple aggregation: ' WS-NAIVE-TIME ' ms'.
           DISPLAY 'Total salary: ' WS-TOTAL-SALARY.
           
       TEST-BATCH-AGGREGATION.
           DISPLAY 'Testing batch aggregation...'.
           
           MOVE FUNCTION CURRENT-DATE TO WS-START-
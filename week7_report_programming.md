# Á¨¨‰∏ÉÈÄ±ÔºöÂ†±Ë°®Á®ãÂºèË®≠Ë®à - ÂÆåÊï¥ÊïôÊùê

## üìö Êú¨ÈÄ±Â≠∏ÁøíÁõÆÊ®ô

ÂÆåÊàêÊú¨ÈÄ±Â≠∏ÁøíÂæåÔºåÂ≠∏Âì°Â∞áËÉΩÂ§†Ôºö
- ÁêÜËß£AS/400Â†±Ë°®Á≥ªÁµ±ÁöÑÊû∂ÊßãÂíåË®≠Ë®àÂéüÁêÜ
- ÊéåÊè°PRTFÔºàPrint FileÔºâÁöÑË®≠Ë®àÂíåÂØ¶‰ΩúÊäÄË°ì
- ÁÜüÁ∑¥‰ΩøÁî®ÂêÑÁ®ÆÂ†±Ë°®Ê†ºÂºèÂåñÂíåÊéßÂà∂ÊäÄÂ∑ß
- Ë®≠Ë®àÂ∞àÊ•≠ÁöÑÂïÜÊ•≠Â†±Ë°®ÂíåÁµ±Ë®àÂàÜÊûê
- ÂØ¶‰ΩúË§áÈõúÁöÑÂàÜÁµÑ„ÄÅÂ∞èË®àÂíåÁ∏ΩË®àÈÇèËºØ
- ÈñãÁôºÂ§öÊ®£ÂåñÁöÑÂ†±Ë°®Ëº∏Âá∫Ê†ºÂºèÂíåÂàÜÁôºÊ©üÂà∂

---

## üìä Á¨¨‰∏ÄÁØÄÔºöÂ†±Ë°®Á®ãÂºèË®≠Ë®àÊ¶ÇË´ñ

### 1.1 AS/400Â†±Ë°®Á≥ªÁµ±Êû∂Êßã

#### 1.1.1 Â†±Ë°®Á≥ªÁµ±ÁµÑÊàêË¶ÅÁ¥†

```
AS/400 Â†±Ë°®Á≥ªÁµ±Êû∂ÊßãÔºö
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Ëº∏Âá∫‰ªãÈù¢Â±§ (Output Interface Layer)     ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ Âç∞Ë°®Ê©üËº∏Âá∫                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÂØ¶È´îÂç∞Ë°®Ê©üÂàóÂç∞                   ‚îÇ ‚îÇ
‚îÇ ‚îÇ - SpoolÊ™îÊ°àÁÆ°ÁêÜ                    ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Á∂≤Ë∑ØÂç∞Ë°®Ê©üÊîØÊè¥                   ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ ÈõªÂ≠êÂåñËº∏Âá∫                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ - PDFÊ™îÊ°àÁî¢Áîü                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ExcelÊ†ºÂºèËº∏Âá∫                    ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÈõªÂ≠êÈÉµ‰ª∂ÁôºÈÄÅ                     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üï Ê†ºÂºèÊéßÂà∂
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÂàóÂç∞Ê™îÊ°àÂ±§ (Print File Layer - PRTF)   ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ DDSÂÆöÁæ©Â†±Ë°®Ê†ºÂºè                    ‚îÇ ‚îÇ
‚îÇ ‚îÇ - È†ÅÈù¢‰ΩàÂ±ÄÊéßÂà∂                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ê¨Ñ‰ΩçÊ†ºÂºèÂÆöÁæ©                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÇ ÂàÜÈ†ÅÂíåÊèõË°åÊéßÂà∂                   ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üï Ë≥áÊñôËôïÁêÜ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÊáâÁî®Á®ãÂºèÂ±§ (Application Program Layer) ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ COBOLÂ†±Ë°®Á®ãÂºè                      ‚îÇ ‚îÇ
‚îÇ ‚îÇ - Ë≥áÊñôÊì∑ÂèñÂíåÊï¥ÁêÜ                   ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÂïÜÊ•≠ÈÇèËºØËôïÁêÜ                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ - ÂàÜÁµÑÂíåÁµ±Ë®àË®àÁÆó                   ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 1.1.2 Â†±Ë°®Ë®≠Ë®àÂéüÂâá

```cobol
      *    Â∞àÊ•≠Â†±Ë°®Ë®≠Ë®àÁöÑÊ†∏ÂøÉÂéüÂâáÔºö
      *
      *    1. Ë≥áË®äÂëàÁèæ (Information Presentation)
      *       - Ê∏ÖÊô∞ÁöÑÊ®ôÈ°åÂíåÊ¨Ñ‰ΩçÊ®ôÈ†≠
      *       - ÂêàÁêÜÁöÑË≥áÊñôÂàÜÁµÑ
      *       - ÈÅ©Áï∂ÁöÑÂ∞èË®àÂíåÁ∏ΩË®à
      *       - ‰∏ÄËá¥ÁöÑÊ†ºÂºèÂåñÊ®ôÊ∫ñ
      *
      *    2. ÁâàÈù¢ÈÖçÁΩÆ (Layout Design)
      *       - ÂÖÖÂàÜÂà©Áî®È†ÅÈù¢Á©∫Èñì
      *       - ÈÅ©Áï∂ÁöÑÈÇäÁïåÂíåÈñìË∑ù
      *       - Â∞çÈΩäÂíåË¶ñË¶∫Âπ≥Ë°°
      *       - ÂàÜÈ†ÅÈÇèËºØÂêàÁêÜ
      *
      *    3. ‰ΩøÁî®ËÄÖÈúÄÊ±Ç (User Requirements)
      *       - Á¨¶ÂêàÂïÜÊ•≠ÈúÄÊ±Ç
      *       - ÊîØÊè¥Ê±∫Á≠ñÂà∂ÂÆö
      *       - ÊòìÊñºÁêÜËß£Âíå‰ΩøÁî®
      *       - ÈÅ©ÂêàÂàóÂç∞ÂíåÈõªÂ≠êÊ™¢Ë¶ñ
      *
      *    4. ÊïàËÉΩËÄÉÈáè (Performance Considerations)
      *       - È´òÊïàÁöÑË≥áÊñôÊì∑Âèñ
      *       - ÊúÄ‰Ω≥ÂåñÁöÑÊéíÂ∫èÈÇèËºØ
      *       - ÈÅ©Áï∂ÁöÑË®òÊÜ∂È´î‰ΩøÁî®
      *       - ÂêàÁêÜÁöÑÂü∑Ë°åÊôÇÈñì
```

### 1.2 ÂàóÂç∞Ê™îÊ°àÂü∫Êú¨Ê¶ÇÂøµ

#### 1.2.1 PRTFÊ™îÊ°àÁâπËâ≤

```dds
      *    AS/400 ÂàóÂç∞Ê™îÊ°àÁâπËâ≤Ôºö
      *
      *    1. È†ÅÈù¢ÊéßÂà∂ (Page Control)
      *       - SPACEA/SPACEB: ÊèõË°åÊéßÂà∂
      *       - SKIPB/SKIPA: Ë∑≥Ë°åÊéßÂà∂  
      *       - PAGNBR: È†ÅÁ¢ºÊéßÂà∂
      *
      *    2. Ê¨Ñ‰ΩçÊ†ºÂºèÂåñ (Field Formatting)
      *       - EDTCDE: Á∑®ËºØÁ¢º
      *       - EDTWRD: Á∑®ËºØÂ≠ó
      *       - DATE/TIME: Êó•ÊúüÊôÇÈñìÊ†ºÂºè
      *
      *    3. Ê¢ù‰ª∂ÊéßÂà∂ (Conditional Control)
      *       - ÊåáÁ§∫Âô®ÊéßÂà∂ÂàóÂç∞
      *       - Ê¢ù‰ª∂ÂºèÊèõË°å
      *       - ÂãïÊÖãÂÖßÂÆπÈ°ØÁ§∫
      *
      *    4. Ê∫¢ÊµÅËôïÁêÜ (Overflow Handling)
      *       - Ëá™ÂãïÂàÜÈ†Å
      *       - È†ÅÂ∞æËôïÁêÜ
      *       - ÈÄ£Á∫åÂ†±Ë°®ÊîØÊè¥
```

#### 1.2.2 DDSÈóúÈçµÂ≠óÂàÜÈ°û

```dds
      * ÂàóÂç∞Ê™îÊ°àDDSÈóúÈçµÂ≠óÂàÜÈ°û
      *
      * Ê™îÊ°àÂ±§Á¥öÈóúÈçµÂ≠óÔºö
      * - PAGESIZE(66 132)     È†ÅÈù¢Â§ßÂ∞èË®≠ÂÆö
      * - FOLD                 Êë∫ÁñäÂàóÂç∞
      * - FLTFIXDEC            ÊµÆÈªûÊï∏ËôïÁêÜ
      * - INDTXT               ÊåáÁ§∫Âô®ÊñáÂ≠ó
      *
      * Ë®òÈåÑÂ±§Á¥öÈóúÈçµÂ≠óÔºö
      * - SPACEA(1)            ÂàóÂç∞ÂæåÊèõË°å
      * - SPACEB(2)            ÂàóÂç∞ÂâçÊèõË°å  
      * - SKIPB(1)             ÂàóÂç∞ÂâçË∑≥Ë°å
      * - SKIPA(99)            ÂàóÂç∞ÂæåË∑≥Ë°å
      * - OVERLAY              ÁñäÂç∞
      *
      * Ê¨Ñ‰ΩçÂ±§Á¥öÈóúÈçµÂ≠óÔºö
      * - EDTCDE(J)            Á∑®ËºØÁ¢º
      * - EDTWRD(' . . ')      Á∑®ËºØÂ≠ó
      * - PAGNBR               È†ÅÁ¢º
      * - DATE                 Á≥ªÁµ±Êó•Êúü
      * - TIME                 Á≥ªÁµ±ÊôÇÈñì
```

---

## üìÑ Á¨¨‰∫åÁØÄÔºöÂü∫Êú¨Â†±Ë°®Ê†ºÂºèË®≠Ë®à

### 2.1 Á∞°ÂñÆÊ∏ÖÂñÆÂ†±Ë°®

#### 2.1.1 Âì°Â∑•Ê∏ÖÂñÆÂ†±Ë°®DDS

```dds
      *%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
      *%%EC
      *
      * Âì°Â∑•Ê∏ÖÂñÆÂ†±Ë°®Ê†ºÂºèÂÆöÁæ©
      *
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                      PAGESIZE(66 132)
     A                                      FOLD
     A            R HEADING                 SPACEB(1)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                      SKIPA(1)
     A                                 1  1'1'
     A                                 1 50'Âì°Â∑•Ê∏ÖÂñÆÂ†±Ë°®'
     A                                 1 50DSPATR(UL)
     A                                 1120'È†ÅÊ¨°:'
     A                                 1126PAGNBR
     A                                 1126EDTCDE(4)
     A                                 3  1'Â†±Ë°®Êó•Êúü:'
     A                                 3 11DATE
     A                                 3 11EDTCDE(Y)
     A                                 3120'ÂàóÂç∞ÊôÇÈñì:'
     A                                 3130TIME
     A            COMPNAME      30A  O  5  1
     A                                 7  1'Âì°Â∑•Á∑®Ëôü'
     A                                 7 10'Âì°Â∑•ÂßìÂêç'
     A                                 7 31'ÈÉ®ÈñÄ'
     A                                 7 41'ËÅ∑‰Ωç'
     A                                 7 57'Ëñ™Ë≥á'
     A                                 7 70'Âà∞ËÅ∑Êó•Êúü'
     A                                 7 85'ÁãÄÊÖã'
     A                                 7 95'ÈõªË©±'
     A                                 8  1'--------'
     A                                 8 10'--------------------'
     A                                 8 31'--------'
     A                                 8 41'---------------'
     A                                 8 57'----------'
     A                                 8 70'-----------'
     A                                 8 85'----'
     A                                 8 95'---------------'
     A            R DETAIL                 SPACEA(1)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A            EMPID          6A  O  9  1
     A            EMPNAME       20A  O  9 10
     A            DEPTNAME       8A  O  9 31
     A            POSITION      15A  O  9 41
     A            SALARY         7P 2O  9 57EDTCDE(1)
     A            HIREDATE      10A  O  9 70
     A            STATUS         1A  O  9 85
     A            PHONE         15A  O  9 95
     A            R DEPTHEAD               SPACEB(2)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                SPACEA(1)
     A                                10  1'ÈÉ®ÈñÄ: '
     A            DEPTHEADING    25A  O 10  8
     A            R DEPTFOOT               SPACEA(1)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                11  1'ÈÉ®ÈñÄÂ∞èË®à:'
     A            DEPTCOUNT       4  0O 11 15EDTCDE(4)
     A                                11 20'‰∫∫'
     A            DEPTTOTAL       9P 2O 11 57EDTCDE(1)
     A            R GRANDTOTAL             SPACEB(2)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                SPACEA(1)
     A                                12  1'Á∏ΩË®à:'
     A            GRANDCOUNT      5  0O 12 15EDTCDE(4)
     A                                12 20'‰∫∫'
     A            GRANDSUM       10P 2O 12 57EDTCDE(1)
     A                                12 75'Âπ≥ÂùáËñ™Ë≥á:'
     A            AVGSAL          8P 2O 12 87EDTCDE(1)
     A            R OVERFLOW               SPACEA(1)
     A*%%TS PD 20240130 100000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                SKIPA(99)
```

#### 2.1.2 Âì°Â∑•Ê∏ÖÂñÆÂ†±Ë°®Á®ãÂºè

```cobol
      *****************************************************************
      * Á®ãÂºèÂêçÁ®±ÔºöEMPLSTR                                            *
      * Á®ãÂºèÂäüËÉΩÔºöÂì°Â∑•Ê∏ÖÂñÆÂ†±Ë°®                                       *
      * ‰ΩúËÄÖÔºöÂ†±Ë°®Ë®≠Ë®àÂ∏´                                             *
      * Êó•ÊúüÔºö2024/01/30                                             *
      *****************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. EMPLSTR.
       
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT EMPLIST-REPORT
               ASSIGN TO PRINTER-QPRINT.
               
           SELECT EMPLOYEE-FILE
               ASSIGN TO DATABASE-EMPMASTER
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS EMP-ID
               FILE STATUS IS WS-EMP-FILE-STATUS.
               
           SELECT DEPARTMENT-FILE
               ASSIGN TO DATABASE-DEPTMASTER
               ORGANIZATION IS INDEXED
               ACCESS MODE IS RANDOM
               RECORD KEY IS DEPT-CODE
               FILE STATUS IS WS-DEPT-FILE-STATUS.
               
       DATA DIVISION.
       FILE SECTION.
       
       FD  EMPLIST-REPORT
           USAGE IS DISPLAY.
       01  EMPLIST-RECORD.
           COPY DDS-ALL-FORMATS OF EMPLISTR.
           
       FD  EMPLOYEE-FILE.
       01  EMPLOYEE-RECORD.
           COPY EMPFMT OF EMPMASTER.
           
       FD  DEPARTMENT-FILE.
       01  DEPARTMENT-RECORD.
           COPY DEPTFMT OF DEPTMASTER.
           
       WORKING-STORAGE SECTION.
       
      *    Ê™îÊ°àÁãÄÊÖã
       01  WS-FILE-STATUS.
           05  WS-EMP-FILE-STATUS  PIC XX.
               88  EMP-FILE-SUCCESS        VALUE '00'.
               88  EMP-FILE-EOF            VALUE '10'.
           05  WS-DEPT-FILE-STATUS PIC XX.
               88  DEPT-FILE-SUCCESS       VALUE '00'.
               
      *    ÊéßÂà∂ËÆäÊï∏
       01  WS-CONTROL-FIELDS.
           05  WS-CURRENT-DEPT     PIC X(4).
           05  WS-PREVIOUS-DEPT    PIC X(4).
           05  WS-FIRST-RECORD     PIC X.
               88  FIRST-RECORD            VALUE 'Y'.
               88  NOT-FIRST-RECORD        VALUE 'N'.
           05  WS-PAGE-COUNT       PIC 9(3) VALUE 0.
           05  WS-LINE-COUNT       PIC 99 VALUE 99.
           05  WS-MAX-LINES        PIC 99 VALUE 55.
           
      *    Áµ±Ë®àËÆäÊï∏
       01  WS-STATISTICS.
           05  WS-DEPT-COUNT       PIC 9(4) VALUE 0.
           05  WS-DEPT-TOTAL       PIC 9(9)V99 VALUE 0.
           05  WS-GRAND-COUNT      PIC 9(5) VALUE 0.
           05  WS-GRAND-TOTAL      PIC 9(10)V99 VALUE 0.
           05  WS-AVERAGE-SALARY   PIC 9(8)V99 VALUE 0.
           
      *    Â∑•‰ΩúËÆäÊï∏
       01  WS-WORK-FIELDS.
           05  WS-COMPANY-NAME     PIC X(30) VALUE 'Âè∞ÁÅ£ÁßëÊäÄËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏'.
           
       PROCEDURE DIVISION.
       
       MAIN-LOGIC.
           PERFORM INITIALIZE-PROGRAM
           PERFORM PROCESS-EMPLOYEES
           PERFORM PRINT-GRAND-TOTAL
           PERFORM TERMINATE-PROGRAM.
           STOP RUN.
           
       INITIALIZE-PROGRAM.
           OPEN OUTPUT EMPLIST-REPORT.
           OPEN INPUT EMPLOYEE-FILE.
           OPEN INPUT DEPARTMENT-FILE.
           
           SET FIRST-RECORD TO TRUE.
           MOVE HIGH-VALUES TO WS-PREVIOUS-DEPT.
           
       PROCESS-EMPLOYEES.
           PERFORM READ-EMPLOYEE
           PERFORM UNTIL EMP-FILE-EOF
               PERFORM CHECK-DEPARTMENT-BREAK
               PERFORM PROCESS-EMPLOYEE-RECORD
               PERFORM READ-EMPLOYEE
           END-PERFORM.
           
      *    ËôïÁêÜÊúÄÂæå‰∏ÄÂÄãÈÉ®ÈñÄÁöÑÂ∞èË®à
           IF WS-GRAND-COUNT > 0
               PERFORM PRINT-DEPARTMENT-FOOTER
           END-IF.
           
       READ-EMPLOYEE.
           READ EMPLOYEE-FILE
               AT END
                   SET EMP-FILE-EOF TO TRUE
               NOT AT END
                   MOVE EMP-DEPT OF EMPLOYEE-RECORD TO WS-CURRENT-DEPT
           END-READ.
           
       CHECK-DEPARTMENT-BREAK.
           IF WS-CURRENT-DEPT NOT = WS-PREVIOUS-DEPT
               IF NOT FIRST-RECORD
                   PERFORM PRINT-DEPARTMENT-FOOTER
               END-IF
               PERFORM PRINT-DEPARTMENT-HEADER
               MOVE WS-CURRENT-DEPT TO WS-PREVIOUS-DEPT
               MOVE 0 TO WS-DEPT-COUNT
               MOVE 0 TO WS-DEPT-TOTAL
               SET NOT-FIRST-RECORD TO TRUE
           END-IF.
           
       PROCESS-EMPLOYEE-RECORD.
           PERFORM CHECK-PAGE-OVERFLOW.
           
           MOVE EMP-ID OF EMPLOYEE-RECORD TO EMPID OF DETAIL.
           MOVE EMP-NAME OF EMPLOYEE-RECORD TO EMPNAME OF DETAIL.
           MOVE EMP-DEPT OF EMPLOYEE-RECORD TO DEPTNAME OF DETAIL.
           MOVE EMP-POSITION OF EMPLOYEE-RECORD TO POSITION OF DETAIL.
           MOVE EMP-SALARY OF EMPLOYEE-RECORD TO SALARY OF DETAIL.
           MOVE EMP-HIRE-DATE OF EMPLOYEE-RECORD TO HIREDATE OF DETAIL.
           MOVE EMP-STATUS OF EMPLOYEE-RECORD TO STATUS OF DETAIL.
           MOVE EMP-PHONE OF EMPLOYEE-RECORD TO PHONE OF DETAIL.
           
           WRITE EMPLIST-RECORD FORMAT IS DETAIL.
           ADD 1 TO WS-LINE-COUNT.
           
      *    Á¥ØË®àÁµ±Ë®à
           ADD 1 TO WS-DEPT-COUNT.
           ADD EMP-SALARY OF EMPLOYEE-RECORD TO WS-DEPT-TOTAL.
           ADD 1 TO WS-GRAND-COUNT.
           ADD EMP-SALARY OF EMPLOYEE-RECORD TO WS-GRAND-TOTAL.
           
       PRINT-DEPARTMENT-HEADER.
           PERFORM CHECK-PAGE-OVERFLOW.
           
      *    ÂèñÂæóÈÉ®ÈñÄÂêçÁ®±
           MOVE WS-CURRENT-DEPT TO DEPT-CODE OF DEPARTMENT-RECORD.
           READ DEPARTMENT-FILE
               INVALID KEY
                   MOVE WS-CURRENT-DEPT TO DEPTHEADING OF DEPTHEAD
               NOT INVALID KEY
                   STRING DEPT-NAME OF DEPARTMENT-RECORD 
                          ' (' WS-CURRENT-DEPT ')'
                          DELIMITED BY SIZE
                          INTO DEPTHEADING OF DEPTHEAD
           END-READ.
           
           WRITE EMPLIST-RECORD FORMAT IS DEPTHEAD.
           ADD 2 TO WS-LINE-COUNT.
           
       PRINT-DEPARTMENT-FOOTER.
           MOVE WS-DEPT-COUNT TO DEPTCOUNT OF DEPTFOOT.
           MOVE WS-DEPT-TOTAL TO DEPTTOTAL OF DEPTFOOT.
           
           WRITE EMPLIST-RECORD FORMAT IS DEPTFOOT.
           ADD 1 TO WS-LINE-COUNT.
           
       CHECK-PAGE-OVERFLOW.
           IF WS-LINE-COUNT > WS-MAX-LINES
               PERFORM PRINT-PAGE-HEADER
           END-IF.
           
       PRINT-PAGE-HEADER.
           ADD 1 TO WS-PAGE-COUNT.
           MOVE WS-COMPANY-NAME TO COMPNAME OF HEADING.
           
           WRITE EMPLIST-RECORD FORMAT IS HEADING.
           MOVE 8 TO WS-LINE-COUNT.
           
       PRINT-GRAND-TOTAL.
           IF WS-GRAND-COUNT > 0
               COMPUTE WS-AVERAGE-SALARY = WS-GRAND-TOTAL / WS-GRAND-COUNT
           END-IF.
           
           MOVE WS-GRAND-COUNT TO GRANDCOUNT OF GRANDTOTAL.
           MOVE WS-GRAND-TOTAL TO GRANDSUM OF GRANDTOTAL.
           MOVE WS-AVERAGE-SALARY TO AVGSAL OF GRANDTOTAL.
           
           WRITE EMPLIST-RECORD FORMAT IS GRANDTOTAL.
           
       TERMINATE-PROGRAM.
           CLOSE EMPLIST-REPORT.
           CLOSE EMPLOYEE-FILE.
           CLOSE DEPARTMENT-FILE.
```

### 2.2 Áµ±Ë®àÂàÜÊûêÂ†±Ë°®

#### 2.2.1 ÈÉ®ÈñÄÁµ±Ë®àÂ†±Ë°®DDS

```dds
      *
      * ÈÉ®ÈñÄÁµ±Ë®àÂàÜÊûêÂ†±Ë°®Ê†ºÂºèÂÆöÁæ©
      *
     A*%%TS PD 20240130 110000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                      PAGESIZE(66 132)
     A            R STATHEADER              SPACEB(1)
     A*%%TS PD 20240130 110000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                      SKIPA(1)
     A                                 1  1'1'
     A                                 1 45'ÈÉ®ÈñÄÁµ±Ë®àÂàÜÊûêÂ†±Ë°®'
     A                                 1 45DSPATR(UL)
     A                                 1120'È†ÅÊ¨°:'
     A                                 1126PAGNBR
     A                                 1126EDTCDE(4)
     A                                 3  1'Â†±Ë°®Êó•Êúü:'
     A                                 3 11DATE
     A                                 3 11EDTCDE(Y)
     A                                 3120'ÂàóÂç∞ÊôÇÈñì:'
     A                                 3130TIME
     A            COMPNAME      30A  O  5  1
     A            REPORTPARAM   50A  O  6  1
     A                                 8  1'ÈÉ®ÈñÄ‰ª£Á¢º'
     A                                 8 10'ÈÉ®ÈñÄÂêçÁ®±'
     A                                 8 31'‰∏ªÁÆ°ÂßìÂêç'
     A                                 8 46'Âì°Â∑•‰∫∫Êï∏'
     A                                 8 57'Ëñ™Ë≥áÁ∏ΩÈ°ç'
     A                                 8 72'Âπ≥ÂùáËñ™Ë≥á'
     A                                 8 87'ÊúÄÈ´òËñ™Ë≥á'
     A                                 8102'ÊúÄ‰ΩéËñ™Ë≥á'
     A                                 8117'È†êÁÆóÈ§òÈ°ç'
     A                                 9  1'--------'
     A                                 9 10'--------------------'
     A                                 9 31'--------------'
     A                                 9 46'--------'
     A                                 9 57'------------'
     A                                 9 72'------------'
     A                                 9 87'------------'
     A                                 9102'------------'
     A                                 9117'------------'
     A            R STATDETAIL              SPACEA(1)
     A*%%TS PD 20240130 110000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A            DEPTCODE       4A  O 10  1
     A            DEPTNAME      20A  O 10 10
     A            MANAGERNAME   14A  O 10 31
     A            EMPCOUNT       4  0O 10 46EDTCDE(4)
     A            SALARYSUM     10P 2O 10 57EDTCDE(1)
     A            SALARYAVG      8P 2O 10 72EDTCDE(1)
     A            SALARYMAX      8P 2O 10 87EDTCDE(1)
     A            SALARYMIN      8P 2O 10102EDTCDE(1)
     A            BUDGETBAL     10P 2O 10117EDTCDE(1)
     A            R STATTOTAL              SPACEB(2)
     A*%%TS PD 20240130 110000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                SPACEA(1)
     A                                11  1'Áµ±Ë®àÁ∏ΩË®à:'
     A            TOTALDEPTS      3  0O 11 15EDTCDE(4)
     A                                11 19'ÂÄãÈÉ®ÈñÄ'
     A            TOTALEMPS       5  0O 11 46EDTCDE(4)
     A                                11 52'‰∫∫'
     A            TOTALSAL       11P 2O 11 57EDTCDE(1)
     A            OVERALLAVG      8P 2O 11 72EDTCDE(1)
     A            TOTALBUDGET    11P 2O 11117EDTCDE(1)
     A            R ANALYSIS               SPACEB(3)
     A*%%TS PD 20240130 110000 USER1    REL-V7R3M0 5770-WDS
     A*%%EC
     A                                SPACEA(1)
     A                                12  1'ÂàÜÊûêÊëòË¶Å:'
     A                                13  5'1. ÊúÄÂ§ßÈÉ®ÈñÄ:'
     A            BIGGESTDEPT    20A  O 13 18
     A            BIGGESTCOUNT    4  0O 13 40EDTCDE(4)
     A                                13 45'‰∫∫'
     A                                14  5'2. Ëñ™Ë≥áÊúÄÈ´òÈÉ®ÈñÄ:'
     A            RICHESTDEPT    20A  O 14 22
     A            RICHESTSAL      8P 2O 14 44EDTCDE(1)
     A                                15  5'3. ÊïàÁéáÊúÄ‰Ω≥ÈÉ®ÈñÄ:'
     A            EFFICIENTDEPT  20A  O 15 22
     A            EFFICIENTRATIO  5P 2O 15 44EDTCDE(3)
     A                                15 51'%'
     A                                16  5'4. È†êÁÆó‰ΩøÁî®Áéá:'
     A            BUDGETUSAGE     5P 2O 16 18EDTCDE(3)
     A                                16 25'%'
```

#### 2.2.2 ÈÉ®ÈñÄÁµ±Ë®àÂ†±Ë°®Á®ãÂºè

```cobol
      *****************************************************************
      * Á®ãÂºèÂêçÁ®±ÔºöDEPTSTAT                                           *
      * Á®ãÂºèÂäüËÉΩÔºöÈÉ®ÈñÄÁµ±Ë®àÂàÜÊûêÂ†±Ë°®                                   *
      * ‰ΩúËÄÖÔºöÁµ±Ë®àÂàÜÊûêÂ∏´                                             *
      * Êó•ÊúüÔºö2024/01/30                                             *
      *****************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. DEPTSTAT.
       
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT DEPTSTAT-REPORT
               ASSIGN TO PRINTER-QPRINT.
               
       DATA DIVISION.
       FILE SECTION.
       
       FD  DEPTSTAT-REPORT
           USAGE IS DISPLAY.
       01  DEPTSTAT-RECORD.
           COPY DDS-ALL-FORMATS OF DEPTSTATR.
           
       WORKING-STORAGE SECTION.
       
      *    SQLÂåÖÂê´ÂçÄ
           EXEC SQL
               INCLUDE SQLCA
           END-EXEC.
           
      *    ÈÉ®ÈñÄÁµ±Ë®àË≥áÊñôÁµêÊßã
       01  WS-DEPT-STATISTICS.
           05  WS-DEPT-DATA OCCURS 20 TIMES INDEXED BY WS-IDX.
               10  WS-DEPT-CODE        PIC X(4).
               10  WS-DEPT-NAME        PIC X(20).
               10  WS-MANAGER-NAME     PIC X(14).
               10  WS-EMP-COUNT        PIC 9(4).
               10  WS-SALARY-SUM       PIC 9(10)V99.
               10  WS-SALARY-AVG       PIC 9(8)V99.
               10  WS-SALARY-MAX       PIC 9(8)V99.
               10  WS-SALARY-MIN       PIC 9(8)V99.
               10  WS-BUDGET-BALANCE   PIC 9(10)V99.
               
       01  WS-TOTALS.
           05  WS-TOTAL-DEPTS          PIC 9(3) VALUE 0.
           05  WS-TOTAL-EMPLOYEES      PIC 9(5) VALUE 0.
           05  WS-TOTAL-SALARY         PIC 9(11)V99 VALUE 0.
           05  WS-OVERALL-AVERAGE      PIC 9(8)V99 VALUE 0.
           05  WS-TOTAL-BUDGET         PIC 9(11)V99 VALUE 0.
           
      *    ÂàÜÊûêÁµêÊûú
       01  WS-ANALYSIS.
           05  WS-BIGGEST-DEPT         PIC X(20).
           05  WS-BIGGEST-COUNT        PIC 9(4).
           05  WS-RICHEST-DEPT         PIC X(20).
           05  WS-RICHEST-SALARY       PIC 9(8)V99.
           05  WS-EFFICIENT-DEPT       PIC X(20).
           05  WS-EFFICIENT-RATIO      PIC 9(3)V99.
           05  WS-BUDGET-USAGE         PIC 9(3)V99.
           
      *    Â∑•‰ΩúËÆäÊï∏
       01  WS-WORK-FIELDS.
           05  WS-COMPANY-NAME         PIC X(30) VALUE 'Âè∞ÁÅ£ÁßëÊäÄËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏'.
           05  WS-REPORT-PARAM         PIC X(50).
           05  WS-LINE-COUNT           PIC 99 VALUE 99.
           05  WS-MAX-LINES            PIC 99 VALUE 55.
           
       PROCEDURE DIVISION.
       
       MAIN-LOGIC.
           PERFORM INITIALIZE-PROGRAM
           PERFORM COLLECT-STATISTICS
           PERFORM ANALYZE-DATA
           PERFORM PRINT-REPORT
           PERFORM TERMINATE-PROGRAM.
           STOP RUN.
           
       INITIALIZE-PROGRAM.
           OPEN OUTPUT DEPTSTAT-REPORT.
           MOVE 'Active Employees Only' TO WS-REPORT-PARAM.
           
       COLLECT-STATISTICS.
           PERFORM COLLECT-DEPARTMENT-DATA
           PERFORM CALCULATE-TOTALS.
           
       COLLECT-DEPARTMENT-DATA.
           SET WS-IDX TO 1.
           
           EXEC SQL
               DECLARE DEPT_CURSOR CURSOR FOR
               SELECT D.DEPT_CODE, D.DEPT_
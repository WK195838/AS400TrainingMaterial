# Á¨¨ÂõõÈÄ±ÔºöÊ™îÊ°àËôïÁêÜÂü∫Á§é - ÂÆåÊï¥ÊïôÊùê

## üìö Êú¨ÈÄ±Â≠∏ÁøíÁõÆÊ®ô

ÂÆåÊàêÊú¨ÈÄ±Â≠∏ÁøíÂæåÔºåÂ≠∏Âì°Â∞áËÉΩÂ§†Ôºö
- ÁêÜËß£AS/400Ê™îÊ°àÁ≥ªÁµ±ÁöÑÊû∂ÊßãÂíåÁâπËâ≤
- ÊéåÊè°ÂØ¶È´îÊ™îÊ°àÂíåÈÇèËºØÊ™îÊ°àÁöÑÊ¶ÇÂøµËàáÊáâÁî®
- ÁÜüÁ∑¥‰ΩøÁî®DDSÂÆöÁæ©Ê™îÊ°àÁµêÊßã
- ÈÄ≤Ë°åÂêÑÁ®ÆÊ™îÊ°àÊìç‰ΩúÔºàËÆÄÂèñ„ÄÅÂØ´ÂÖ•„ÄÅÊõ¥Êñ∞„ÄÅÂà™Èô§Ôºâ
- ËôïÁêÜÊ™îÊ°àÈåØË™§ÂíåÁï∞Â∏∏ÁãÄÊ≥Å
- Ë®≠Ë®àÊúâÊïàÁöÑÊ™îÊ°àÂ≠òÂèñÁ≠ñÁï•

---

## üóÇÔ∏è Á¨¨‰∏ÄÁØÄÔºöAS/400Ê™îÊ°àÁ≥ªÁµ±Ê¶ÇË´ñ

### 1.1 Ê™îÊ°àÁ≥ªÁµ±Êû∂Êßã

AS/400Ê™îÊ°àÁ≥ªÁµ±ÊòØ‰∏ÄÂÄãÈ´òÂ∫¶Êï¥ÂêàÁöÑË≥áÊñôÂ∫´Ê™îÊ°àÁ≥ªÁµ±ÔºåËàáÂÖ∂‰ªñÁ≥ªÁµ±‰∏çÂêå‰πãËôïÔºö

#### 1.1.1 Ê™îÊ°àÁ≥ªÁµ±ÁâπËâ≤

```
AS/400Ê™îÊ°àÁ≥ªÁµ±ÁâπÈªûÔºö
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. Áâ©‰ª∂Â∞éÂêëË®≠Ë®à                    ‚îÇ
‚îÇ    - ÊâÄÊúâÊ™îÊ°àÈÉΩÊòØÁâ©‰ª∂              ‚îÇ
‚îÇ    - Áµ±‰∏ÄÁöÑÁâ©‰ª∂ÁÆ°ÁêÜÊ©üÂà∂            ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ 2. ÈóúËÅØÂºèË≥áÊñôÂ∫´Êï¥Âêà                ‚îÇ
‚îÇ    - Ê™îÊ°àÂç≥ÊòØË≥áÊñôË°®                ‚îÇ
‚îÇ    - ÊîØÊè¥SQLÂíåÂÇ≥Áµ±Ê™îÊ°àÂ≠òÂèñ         ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ 3. Ë®òÈåÑÂ±§Á¥öÂ≠òÂèñ                    ‚îÇ
‚îÇ    - ÊîØÊè¥Ë®òÈåÑÂ±§Á¥öÁöÑÈéñÂÆö            ‚îÇ
‚îÇ    - È´òÊïàÁöÑ‰∏¶Ë°åÂ≠òÂèñÊéßÂà∂            ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ 4. Â§öÈáçÂ≠òÂèñË∑ØÂæë                    ‚îÇ
‚îÇ    - ÂØ¶È´îÊ™îÊ°àÂíåÈÇèËºØÊ™îÊ°àÂàÜÈõ¢        ‚îÇ
‚îÇ    - ÈùàÊ¥ªÁöÑË≥áÊñôÊ™¢Ë¶ñ                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 1.1.2 Ê™îÊ°àÈ°ûÂûãÂàÜÈ°û

```cobol
      *    AS/400Ê™îÊ°àÈ°ûÂûãË™™Êòé
      *
      *    1. ÂØ¶È´îÊ™îÊ°à (Physical File - PF)
      *       - ÂØ¶ÈöõÂÑ≤Â≠òË≥áÊñôÁöÑÊ™îÊ°à
      *       - ÂÆöÁæ©Ë®òÈåÑÊ†ºÂºèÂíåÊ¨Ñ‰ΩçÁµêÊßã
      *       - ÊØèÂÄãÂØ¶È´îÊ™îÊ°àÂè™Êúâ‰∏ÄÁ®ÆË®òÈåÑÊ†ºÂºè
      *
      *    2. ÈÇèËºØÊ™îÊ°à (Logical File - LF)
      *       - Êèê‰æõË≥áÊñôÁöÑ‰∏çÂêåÊ™¢Ë¶ñ
      *       - ‰∏çÂØ¶ÈöõÂÑ≤Â≠òË≥áÊñô
      *       - ÂèØ‰ª•Âêà‰ΩµÂ§öÂÄãÂØ¶È´îÊ™îÊ°à
      *       - ÂèØ‰ª•Êèê‰æõ‰∏çÂêåÁöÑÊéíÂ∫èÂíåÈÅ∏Êìá
      *
      *    3. ‰æÜÊ∫êÊ™îÊ°à (Source File)
      *       - ÂÑ≤Â≠òÁ®ãÂºèÂéüÂßãÁ¢º
      *       - Â¶ÇQCBLLESRC, QDDSSRCÁ≠â
      *
      *    4. Âç∞Ë°®Ê™îÊ°à (Printer File - PRTF)
      *       - ÂÆöÁæ©Â†±Ë°®Ê†ºÂºè
      *       - ÊéßÂà∂ÂàóÂç∞Ëº∏Âá∫
```

### 1.2 Ë®òÈåÑÊ†ºÂºèÊ¶ÇÂøµ

#### 1.2.1 Ë®òÈåÑÊ†ºÂºèÂÆöÁæ©

```cobol
      *    Ë®òÈåÑÊ†ºÂºèÊòØAS/400Ê™îÊ°àÁöÑÂü∫Êú¨ÁµêÊßãÂñÆ‰Ωç
      *    ÊØèÂÄãÊ™îÊ°àËá≥Â∞ëÂåÖÂê´‰∏ÄÂÄãË®òÈåÑÊ†ºÂºè
      
      *    ÁØÑ‰æãÔºöÂì°Â∑•‰∏ªÊ™îË®òÈåÑÊ†ºÂºè
      *    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      *    ‚îÇ Ë®òÈåÑÊ†ºÂºèÂêçÁ®±ÔºöEMPFMT             ‚îÇ
      *    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
      *    ‚îÇ Ê¨Ñ‰ΩçÂêçÁ®± ‚îÇ ÂûãÊÖã    ‚îÇ Èï∑Â∫¶        ‚îÇ
      *    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
      *    ‚îÇ EMPID    ‚îÇ CHAR    ‚îÇ 6           ‚îÇ
      *    ‚îÇ EMPNAME  ‚îÇ CHAR    ‚îÇ 20          ‚îÇ
      *    ‚îÇ DEPT     ‚îÇ CHAR    ‚îÇ 4           ‚îÇ
      *    ‚îÇ SALARY   ‚îÇ DECIMAL ‚îÇ 7,2         ‚îÇ
      *    ‚îÇ HIREDATE ‚îÇ DATE    ‚îÇ 10          ‚îÇ
      *    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 1.2.2 Ê¨Ñ‰ΩçÂ±¨ÊÄß

```cobol
      *    Ê¨Ñ‰ΩçÂ±¨ÊÄßË™™ÊòéÔºö
      *
      *    Ë≥áÊñôÂûãÊÖãÔºö
      *    - AÔºöÂ≠óÂÖÉÂûãÊÖã (Alphanumeric)
      *    - PÔºöÂ£ìÁ∏ÆÊï∏ÂÄº (Packed Decimal)
      *    - SÔºöÂçÄÂüüÊï∏ÂÄº (Zoned Decimal)
      *    - BÔºö‰∫åÈÄ≤‰Ωç (Binary)
      *    - FÔºöÊµÆÈªûÊï∏ (Float)
      *    - LÔºöÊó•Êúü (Date)
      *    - TÔºöÊôÇÈñì (Time)
      *    - ZÔºöÊôÇÈñìÊà≥Ë®ò (Timestamp)
      *
      *    Ê¨Ñ‰ΩçÂ±¨ÊÄßÔºö
      *    - ÂøÖÂ°´Ê¨Ñ‰Ωç (Required)
      *    - È†êË®≠ÂÄº (Default Value)
      *    - Ê™¢Êü•ÈôêÂà∂ (Check Constraint)
      *    - ÂèÉËÄÉÂÆåÊï¥ÊÄß (Referential Integrity)
```

---

## üìÑ Á¨¨‰∫åÁØÄÔºöDDS (Data Description Specifications)

### 2.1 DDSÂü∫Êú¨Ê¶ÇÂøµ

DDSÊòØAS/400Á≥ªÁµ±‰∏≠ÂÆöÁæ©Ê™îÊ°à„ÄÅËû¢ÂπïÂíåÂ†±Ë°®Ê†ºÂºèÁöÑË™ûË®ÄÔºö

#### 2.1.1 DDSË™ûÊ≥ïÁµêÊßã

```
DDSË®òÈåÑÊ†ºÂºèÔºö
‰ΩçÁΩÆ   ÂÖßÂÆπ
1-5    Â∫èËôü (ÂèØÈÅ∏)
6      Ë°®ÂñÆÈ°ûÂûã (A=Ê¨Ñ‰Ωç, K=ÈóúÈçµÂ≠ó, R=Ë®òÈåÑ)
7      Ë®ªËß£ÊåáÁ§∫Á¨¶ (*)
8-16   ÂêçÁ®± (Ê¨Ñ‰ΩçÂêçÁ®±„ÄÅË®òÈåÑÊ†ºÂºèÂêçÁ®±Á≠â)
17     ÂèÉËÄÉÁ¨¶Ëôü (R=ÂèÉËÄÉ, Á©∫ÁôΩ=ÂÆöÁæ©)
18     Ë≥áÊñôÂûãÊÖãÊàñÈï∑Â∫¶
19-29  Èï∑Â∫¶ÂíåÂ∞èÊï∏‰ΩçÊï∏
30-44  Áî®Ê≥ï (I=Ëº∏ÂÖ•, O=Ëº∏Âá∫, B=ÂÖ©ËÄÖ)
45-80  ÈóúÈçµÂ≠óÂíåÂèÉÊï∏
```

#### 2.1.2 ÂØ¶È´îÊ™îÊ°àDDSÁØÑ‰æã

```dds
      *%%TS RD 20240120 100000 USER1    REL-V7R3M0 5770-SS1
      *%%EC
      *
      * Âì°Â∑•‰∏ªÊ™îÂØ¶È´îÊ™îÊ°àÂÆöÁæ©
      *
     A*%%TS RD 20240120 100000 USER1    REL-V7R3M0 5770-SS1
     A*%%EC
     A                                      UNIQUE
     A          R EMPFMT                    TEXT('Âì°Â∑•‰∏ªÊ™îË®òÈåÑÊ†ºÂºè')
     A*%%TS RD 20240120 100000 USER1    REL-V7R3M0 5770-SS1
     A*%%EC
     A            EMPID          6A         TEXT('Âì°Â∑•Á∑®Ëôü')
     A                                      COLHDG('Âì°Â∑•' 'Á∑®Ëôü')
     A            EMPNAME       20A         TEXT('Âì°Â∑•ÂßìÂêç')
     A                                      COLHDG('Âì°Â∑•ÂßìÂêç')
     A            DEPT           4A         TEXT('ÈÉ®ÈñÄ‰ª£Á¢º')
     A                                      COLHDG('ÈÉ®ÈñÄ')
     A                                      VALUES('IT' 'HR' 'SALE' 'FIN')
     A            POSITION      15A         TEXT('ËÅ∑‰Ωç')
     A                                      COLHDG('ËÅ∑‰Ωç')
     A            SALARY         7P 2       TEXT('ÊúàËñ™')
     A                                      COLHDG('ÊúàËñ™')
     A                                      EDTCDE(1)
     A            HIREDATE       L          TEXT('Âà∞ËÅ∑Êó•Êúü')
     A                                      COLHDG('Âà∞ËÅ∑' 'Êó•Êúü')
     A                                      DATFMT(*ISO)
     A            STATUS         1A         TEXT('ÁãÄÊÖã')
     A                                      COLHDG('ÁãÄÊÖã')
     A                                      VALUES('A' 'I' 'R')
     A                                      DFT('A')
     A          K EMPID
```

### 2.2 ÈÇèËºØÊ™îÊ°àDDS

#### 2.2.1 Á∞°ÂñÆÈÇèËºØÊ™îÊ°à

```dds
      *
      * ÊåâÈÉ®ÈñÄÊéíÂ∫èÁöÑÂì°Â∑•ÈÇèËºØÊ™îÊ°à
      *
     A*%%TS RD 20240120 110000 USER1    REL-V7R3M0 5770-SS1
     A*%%EC
     A          R EMPFMT                    PFILE(EMPMASTER)
     A          K DEPT
     A          K EMPNAME
```

#### 2.2.2 Â§öÈáçÈóúÈçµÂ≠óÈÇèËºØÊ™îÊ°à

```dds
      *
      * ÊåâËñ™Ë≥áÁØÑÂúçÁØ©ÈÅ∏ÁöÑÂì°Â∑•ÈÇèËºØÊ™îÊ°à
      *
     A*%%TS RD 20240120 120000 USER1    REL-V7R3M0 5770-SS1
     A*%%EC
     A          R EMPFMT                    PFILE(EMPMASTER)
     A*                                     TEXT('È´òËñ™Âì°Â∑•Ê™¢Ë¶ñ')
     A            EMPID
     A            EMPNAME
     A            DEPT
     A            SALARY
     A          S SALARY       COMP(GT 50000.00)
     A          K SALARY
     A          K EMPID
```

#### 2.2.3 Â§öÊ™îÊ°àÈÇèËºØÊ™îÊ°à (Join)

```dds
      *
      * Âì°Â∑•ÂíåÈÉ®ÈñÄË≥áÊñôËÅØÁµêÊ™îÊ°à
      *
     A*%%TS RD 20240120 130000 USER1    REL-V7R3M0 5770-SS1
     A*%%EC
     A          R EMPJOIN                   JFILE(EMPMASTER DEPTMASTER)
     A*                                     TEXT('Âì°Â∑•ÈÉ®ÈñÄËÅØÁµêÊ™îÊ°à')
     A            EMPID
     A            EMPNAME
     A            DEPT
     A            DEPTNAME
     A            MANAGER
     A          J                          JOIN(EMPMASTER DEPTMASTER)
     A          J                          JFLD(DEPT DEPT)
     A          K DEPT
     A          K EMPNAME
```

### 2.3 DDSÈóúÈçµÂ≠ó

#### 2.3.1 Ê™îÊ°àÂ±§Á¥öÈóúÈçµÂ≠ó

```dds
      * Â∏∏Áî®Ê™îÊ°àÂ±§Á¥öÈóúÈçµÂ≠ó
      *
      * UNIQUE          - ‰∏ªÈçµÂîØ‰∏ÄÊÄßÁ¥ÑÊùü
      * REF(Ê™îÊ°àÂêç)     - ÂèÉËÄÉÊ™îÊ°àÂÆöÁæ©
      * TEXT('Ë™™Êòé')    - Ê™îÊ°àË™™Êòé
      * ALTSEQ(Ë°®Ê†ºÂêç)  - Êõø‰ª£ÊéíÂ∫èË°®Ê†º
      * FCFO            - ÂÖàÈÄ≤ÂÖàÂá∫ËôïÁêÜ
      * LIFO            - ÂæåÈÄ≤ÂÖàÂá∫ËôïÁêÜ
      * FIFO            - ÂÖàÈÄ≤ÂÖàÂá∫ËôïÁêÜ
```

#### 2.3.2 Ë®òÈåÑÂ±§Á¥öÈóúÈçµÂ≠ó

```dds
      * Ë®òÈåÑÂ±§Á¥öÈóúÈçµÂ≠ó
      *
      * TEXT('Ë™™Êòé')    - Ë®òÈåÑÊ†ºÂºèË™™Êòé
      * PFILE(Ê™îÊ°àÂêç)   - ÂØ¶È´îÊ™îÊ°àÂêçÁ®±
      * FORMAT(Ê†ºÂºèÂêç)  - Ë®òÈåÑÊ†ºÂºèÂêçÁ®±
```

#### 2.3.3 Ê¨Ñ‰ΩçÂ±§Á¥öÈóúÈçµÂ≠ó

```dds
      * Ê¨Ñ‰ΩçÂ±§Á¥öÈóúÈçµÂ≠óÁØÑ‰æã
      *
     A            CUSTNO         6P 0       TEXT('ÂÆ¢Êà∂Á∑®Ëôü')
     A                                      COLHDG('ÂÆ¢Êà∂' 'Á∑®Ëôü')
     A                                      EDTCDE(4)
     A                                      ALIAS(CUSTOMER_NUMBER)
     A            CUSTNAME      30A         TEXT('ÂÆ¢Êà∂ÂêçÁ®±')
     A                                      COLHDG('ÂÆ¢Êà∂ÂêçÁ®±')
     A            CREDITLIMIT    8P 2       TEXT('‰ø°Áî®È°çÂ∫¶')
     A                                      COLHDG('‰ø°Áî®È°çÂ∫¶')
     A                                      DFT(10000.00)
     A                                      RANGE(0 999999.99)
     A            PHONE         15A         TEXT('ÈõªË©±ËôüÁ¢º')
     A                                      COLHDG('ÈõªË©±')
     A                                      CMP(NN)
     A            EMAIL         50A         TEXT('ÈõªÂ≠êÈÉµ‰ª∂')
     A                                      COLHDG('ÈõªÂ≠êÈÉµ‰ª∂')
     A            REGDATE        L          TEXT('Ë®ªÂÜäÊó•Êúü')
     A                                      COLHDG('Ë®ªÂÜä' 'Êó•Êúü')
     A                                      DFT(%DATE)
     A                                      DATFMT(*ISO)
```

---

## üîÑ Á¨¨‰∏âÁØÄÔºöÂü∫Êú¨Ê™îÊ°àÊìç‰Ωú

### 3.1 Ê™îÊ°àÂÆöÁæ©Âú®COBOL‰∏≠

#### 3.1.1 FILE-CONTROLÂÆöÁæ©

```cobol
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *    Âì°Â∑•‰∏ªÊ™îÂÆöÁæ©
           SELECT EMPLOYEE-FILE
               ASSIGN TO DATABASE-EMPMASTER
               ORGANIZATION IS INDEXED
               ACCESS MODE IS RANDOM
               RECORD KEY IS EMP-ID
               FILE STATUS IS WS-EMP-FILE-STATUS.
               
      *    ÂÆ¢Êà∂‰∏ªÊ™îÂÆöÁæ©
           SELECT CUSTOMER-FILE
               ASSIGN TO DATABASE-CUSTMASTER
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-CUST-FILE-STATUS.
               
      *    ‰∫§ÊòìÊòéÁ¥∞Ê™îÂÆöÁæ©
           SELECT TRANSACTION-FILE
               ASSIGN TO DATABASE-TRANSFILE
               ORGANIZATION IS SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-TRANS-FILE-STATUS.
```

#### 3.1.2 Ê™îÊ°àÊèèËø∞ (FD)

```cobol
       DATA DIVISION.
       FILE SECTION.
       
      *    Âì°Â∑•‰∏ªÊ™îÊ™îÊ°àÊèèËø∞
       FD  EMPLOYEE-FILE
           LABEL RECORDS ARE STANDARD
           RECORD CONTAINS 60 CHARACTERS
           DATA RECORD IS EMPLOYEE-RECORD.
       01  EMPLOYEE-RECORD.
           COPY EMPFMT OF EMPMASTER.
           
      *    ÂÆ¢Êà∂‰∏ªÊ™îÊ™îÊ°àÊèèËø∞
       FD  CUSTOMER-FILE
           LABEL RECORDS ARE STANDARD
           DATA RECORD IS CUSTOMER-RECORD.
       01  CUSTOMER-RECORD.
           05  CUST-ID            PIC X(6).
           05  CUST-NAME          PIC X(30).
           05  CUST-ADDRESS       PIC X(50).
           05  CUST-PHONE         PIC X(15).
           05  CUST-CREDIT-LIMIT  PIC 9(8)V99.
           
      *    ‰∫§ÊòìÊòéÁ¥∞Ê™îÊ™îÊ°àÊèèËø∞
       FD  TRANSACTION-FILE
           LABEL RECORDS ARE STANDARD
           DATA RECORD IS TRANSACTION-RECORD.
       01  TRANSACTION-RECORD.
           05  TRANS-ID           PIC X(10).
           05  TRANS-DATE         PIC X(10).
           05  CUST-ID            PIC X(6).
           05  PRODUCT-ID         PIC X(8).
           05  QUANTITY           PIC 9(5).
           05  UNIT-PRICE         PIC 9(6)V99.
           05  TOTAL-AMOUNT       PIC 9(8)V99.
```

### 3.2 Ê™îÊ°àÁãÄÊÖãËôïÁêÜ

#### 3.2.1 Ê™îÊ°àÁãÄÊÖãÁ¢ºÂÆöÁæ©

```cobol
       WORKING-STORAGE SECTION.
       
      *    Ê™îÊ°àÁãÄÊÖãËÆäÊï∏
       01  WS-FILE-STATUS-CODES.
           05  WS-EMP-FILE-STATUS    PIC XX.
               88  EMP-FILE-SUCCESS        VALUE '00'.
               88  EMP-FILE-EOF            VALUE '10'.
               88  EMP-FILE-NOT-FOUND      VALUE '23'.
               88  EMP-FILE-DUPLICATE      VALUE '22'.
               88  EMP-FILE-ERROR          VALUE '24' '30' '34' '35'
                                                 '37' '38' '39' '41'
                                                 '42' '43' '44' '46'
                                                 '47' '48' '49' '90'
                                                 '91' '92' '93' '94'
                                                 '95' '96' '97' '98'
                                                 '99'.
           
           05  WS-CUST-FILE-STATUS   PIC XX.
               88  CUST-FILE-SUCCESS       VALUE '00'.
               88  CUST-FILE-EOF           VALUE '10'.
               88  CUST-FILE-NOT-FOUND     VALUE '23'.
               
           05  WS-TRANS-FILE-STATUS  PIC XX.
               88  TRANS-FILE-SUCCESS      VALUE '00'.
               88  TRANS-FILE-EOF          VALUE '10'.
```

#### 3.2.2 Ê™îÊ°àÈåØË™§ËôïÁêÜÂ≠êÁ®ãÂºè

```cobol
       CHECK-FILE-STATUS.
           EVALUATE TRUE
               WHEN EMP-FILE-SUCCESS
                   CONTINUE
               WHEN EMP-FILE-EOF
                   DISPLAY 'INFO: Ê™îÊ°àÁµêÊùü'
               WHEN EMP-FILE-NOT-FOUND
                   DISPLAY 'ERROR: Ë®òÈåÑ‰∏çÂ≠òÂú®'
               WHEN EMP-FILE-DUPLICATE
                   DISPLAY 'ERROR: ÈáçË§áÁöÑÈçµÂÄº'
               WHEN EMP-FILE-ERROR
                   DISPLAY 'ERROR: Ê™îÊ°àÈåØË™§ÔºåÁãÄÊÖãÁ¢º: ' WS-EMP-FILE-STATUS
               WHEN OTHER
                   DISPLAY 'WARNING: Êú™Áü•ÁãÄÊÖãÁ¢º: ' WS-EMP-FILE-STATUS
           END-EVALUATE.
```

### 3.3 Ê™îÊ°àÈñãÂïüÂíåÈóúÈñâ

#### 3.3.1 Ê™îÊ°àÈñãÂïü

```cobol
       OPEN-FILES.
      *    ÈñãÂïüÂì°Â∑•‰∏ªÊ™îÈÄ≤Ë°åËÆÄÂèñÂíåÊõ¥Êñ∞
           OPEN I-O EMPLOYEE-FILE.
           IF NOT EMP-FILE-SUCCESS
               DISPLAY 'ERROR: ÁÑ°Ê≥ïÈñãÂïüÂì°Â∑•‰∏ªÊ™î'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-EMP-FILE-STATUS
               PERFORM ABEND-PROGRAM
           END-IF.
           
      *    ÈñãÂïüÂÆ¢Êà∂‰∏ªÊ™îÈÄ≤Ë°åËÆÄÂèñ
           OPEN INPUT CUSTOMER-FILE.
           IF NOT CUST-FILE-SUCCESS
               DISPLAY 'ERROR: ÁÑ°Ê≥ïÈñãÂïüÂÆ¢Êà∂‰∏ªÊ™î'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-CUST-FILE-STATUS
               PERFORM ABEND-PROGRAM
           END-IF.
           
      *    ÈñãÂïü‰∫§ÊòìÊ™îÈÄ≤Ë°åÂØ´ÂÖ•
           OPEN OUTPUT TRANSACTION-FILE.
           IF NOT TRANS-FILE-SUCCESS
               DISPLAY 'ERROR: ÁÑ°Ê≥ïÈñãÂïü‰∫§ÊòìÊ™î'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-TRANS-FILE-STATUS
               PERFORM ABEND-PROGRAM
           END-IF.
           
           DISPLAY 'INFO: ÊâÄÊúâÊ™îÊ°àÈñãÂïüÊàêÂäü'.
```

#### 3.3.2 Ê™îÊ°àÈóúÈñâ

```cobol
       CLOSE-FILES.
           CLOSE EMPLOYEE-FILE.
           IF NOT EMP-FILE-SUCCESS
               DISPLAY 'WARNING: Âì°Â∑•‰∏ªÊ™îÈóúÈñâÁï∞Â∏∏'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-EMP-FILE-STATUS
           END-IF.
           
           CLOSE CUSTOMER-FILE.
           IF NOT CUST-FILE-SUCCESS
               DISPLAY 'WARNING: ÂÆ¢Êà∂‰∏ªÊ™îÈóúÈñâÁï∞Â∏∏'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-CUST-FILE-STATUS
           END-IF.
           
           CLOSE TRANSACTION-FILE.
           IF NOT TRANS-FILE-SUCCESS
               DISPLAY 'WARNING: ‰∫§ÊòìÊ™îÈóúÈñâÁï∞Â∏∏'
               DISPLAY 'Ê™îÊ°àÁãÄÊÖã: ' WS-TRANS-FILE-STATUS
           END-IF.
           
           DISPLAY 'INFO: ÊâÄÊúâÊ™îÊ°àÈóúÈñâÂÆåÊàê'.
```

---

## üìñ Á¨¨ÂõõÁØÄÔºöÂæ™Â∫èÊ™îÊ°àËôïÁêÜ

### 4.1 Âæ™Â∫èËÆÄÂèñ

#### 4.1.1 Âü∫Êú¨Âæ™Â∫èËÆÄÂèñ

```cobol
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-RECORD-COUNT       PIC 9(6) VALUE 0.
       01  WS-TOTAL-SALARY       PIC 9(10)V99 VALUE 0.
       01  WS-AVERAGE-SALARY     PIC 9(8)V99.
       
       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM OPEN-FILES
           PERFORM READ-ALL-EMPLOYEES
           PERFORM CALCULATE-STATISTICS
           PERFORM CLOSE-FILES
           STOP RUN.
           
       READ-ALL-EMPLOYEES.
           PERFORM READ-EMPLOYEE-RECORD
           PERFORM UNTIL CUST-FILE-EOF
               PERFORM PROCESS-EMPLOYEE-RECORD
               PERFORM READ-EMPLOYEE-RECORD
           END-PERFORM.
           
       READ-EMPLOYEE-RECORD.
           READ EMPLOYEE-FILE
               AT END
                   SET CUST-FILE-EOF TO TRUE
               NOT AT END
                   CONTINUE
           END-READ.
           
       PROCESS-EMPLOYEE-RECORD.
           ADD 1 TO WS-RECORD-COUNT.
           ADD EMP-SALARY TO WS-TOTAL-SALARY.
           
           DISPLAY 'Employee: ' EMP-ID ' ' EMP-NAME 
                   ' Salary: ' EMP-SALARY.
           
       CALCULATE-STATISTICS.
           IF WS-RECORD-COUNT > 0
               COMPUTE WS-AVERAGE-SALARY = 
                   WS-TOTAL-SALARY / WS-RECORD-COUNT
               DISPLAY ' '
               DISPLAY '========== Áµ±Ë®àÁµêÊûú =========='
               DISPLAY 'Âì°Â∑•Á∏ΩÊï∏: ' WS-RECORD-COUNT
               DISPLAY 'Ëñ™Ë≥áÁ∏ΩÈ°ç: ' WS-TOTAL-SALARY
               DISPLAY 'Âπ≥ÂùáËñ™Ë≥á: ' WS-AVERAGE-SALARY
           ELSE
               DISPLAY 'INFO: Ê≤íÊúâÂì°Â∑•Ë®òÈåÑ'
           END-IF.
```

#### 4.1.2 Ê¢ù‰ª∂ÁØ©ÈÅ∏ËÆÄÂèñ

```cobol
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-HIGH-SALARY-COUNT  PIC 9(4) VALUE 0.
       01  WS-DEPT-COUNT.
           05  WS-IT-COUNT       PIC 9(4) VALUE 0.
           05  WS-HR-COUNT       PIC 9(4) VALUE 0.
           05  WS-SALES-COUNT    PIC 9(4) VALUE 0.
           05  WS-FINANCE-COUNT  PIC 9(4) VALUE 0.
       
       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM OPEN-FILES
           PERFORM PROCESS-FILTERED-EMPLOYEES
           PERFORM DISPLAY-SUMMARY
           PERFORM CLOSE-FILES
           STOP RUN.
           
       PROCESS-FILTERED-EMPLOYEES.
           PERFORM READ-EMPLOYEE-RECORD
           PERFORM UNTIL CUST-FILE-EOF
               PERFORM ANALYZE-EMPLOYEE-DATA
               PERFORM READ-EMPLOYEE-RECORD
           END-PERFORM.
           
       ANALYZE-EMPLOYEE-DATA.
      *    Áµ±Ë®àÈ´òËñ™Âì°Â∑•
           IF EMP-SALARY > 60000
               ADD 1 TO WS-HIGH-SALARY-COUNT
               DISPLAY 'High Salary: ' EMP-NAME ' - ' EMP-SALARY
           END-IF.
           
      *    ÊåâÈÉ®ÈñÄÁµ±Ë®à
           EVALUATE EMP-DEPT
               WHEN 'IT'
                   ADD 1 TO WS-IT-COUNT
               WHEN 'HR'
                   ADD 1 TO WS-HR-COUNT
               WHEN 'SALE'
                   ADD 1 TO WS-SALES-COUNT
               WHEN 'FIN'
                   ADD 1 TO WS-FINANCE-COUNT
               WHEN OTHER
                   DISPLAY 'WARNING: Êú™Áü•ÈÉ®ÈñÄ ' EMP-DEPT 
                           ' for employee ' EMP-ID
           END-EVALUATE.
           
       DISPLAY-SUMMARY.
           DISPLAY ' '
           DISPLAY '========== ÈÉ®ÈñÄÁµ±Ë®à =========='
           DISPLAY 'ITÈÉ®ÈñÄ: ' WS-IT-COUNT ' ‰∫∫'
           DISPLAY 'HRÈÉ®ÈñÄ: ' WS-HR-COUNT ' ‰∫∫'
           DISPLAY 'Ê•≠ÂãôÈÉ®ÈñÄ: ' WS-SALES-COUNT ' ‰∫∫'
           DISPLAY 'Ë≤°ÂãôÈÉ®ÈñÄ: ' WS-FINANCE-COUNT ' ‰∫∫'
           DISPLAY 'È´òËñ™Âì°Â∑•: ' WS-HIGH-SALARY-COUNT ' ‰∫∫'
```

### 4.2 Âæ™Â∫èÂØ´ÂÖ•

#### 4.2.1 Âª∫Á´ãÊñ∞Ê™îÊ°à

```cobol
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-NEW-EMPLOYEE.
           05  WS-NEW-EMP-ID     PIC X(6).
           05  WS-NEW-EMP-NAME   PIC X(20).
           05  WS-NEW-DEPT       PIC X(4).
           05  WS-NEW-POSITION   PIC X(15).
           05  WS-NEW-SALARY     PIC 9(7)V99.
           05  WS-NEW-HIRE-DATE  PIC X(10).
           05  WS-NEW-STATUS     PIC X.
       
       01  WS-INPUT-MORE         PIC X.
           88  MORE-INPUT              VALUE 'Y'.
           88  NO-MORE-INPUT           VALUE 'N'.
       
       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM OPEN-OUTPUT-FILE
           PERFORM CREATE-EMPLOYEE-RECORDS
           PERFORM CLOSE-FILES
           STOP RUN.
           
       OPEN-OUTPUT-FILE.
           OPEN OUTPUT EMPLOYEE-FILE.
           IF NOT EMP-FILE-SUCCESS
               DISPLAY 'ERROR: ÁÑ°Ê≥ïÈñãÂïüËº∏Âá∫Ê™îÊ°à'
               STOP RUN
           END-IF.
           
       CREATE-EMPLOYEE-RECORDS.
           MOVE 'Y' TO WS-INPUT-MORE.
           PERFORM UNTIL NO-MORE-INPUT
               PERFORM GET-EMPLOYEE-INPUT
               IF MORE-INPUT
                   PERFORM WRITE-EMPLOYEE-RECORD
               END-IF
           END-PERFORM.
           
       GET-EMPLOYEE-INPUT.
           DISPLAY ' '
           DISPLAY '=== Êñ∞Â¢ûÂì°Â∑•Ë≥áÊñô ==='.
           DISPLAY 'Âì°Â∑•Á∑®Ëôü (6‰Ωç): '.
           ACCEPT WS-NEW-EMP-ID.
           
           IF WS-NEW-EMP-ID = SPACES
               MOVE 'N' TO WS-INPUT-MORE
               EXIT PARAGRAPH
           END-IF.
           
           DISPLAY 'Âì°Â∑•ÂßìÂêç: '.
           ACCEPT WS-NEW-EMP-NAME.
           DISPLAY 'ÈÉ®ÈñÄ‰ª£Á¢º (IT/HR/SALE/FIN): '.
           ACCEPT WS-NEW-DEPT.
           DISPLAY 'ËÅ∑‰Ωç: '.
           ACCEPT WS-NEW-POSITION.
           DISPLAY 'ÊúàËñ™: '.
           ACCEPT WS-NEW-SALARY.
           DISPLAY 'Âà∞ËÅ∑Êó•Êúü (YYYY-MM-DD): '.
           ACCEPT WS-NEW-HIRE-DATE.
           MOVE 'A' TO WS-NEW-STATUS.
           
           DISPLAY 'ÊòØÂê¶ÁπºÁ∫åËº∏ÂÖ•? (Y/N): '.
           ACCEPT WS-INPUT-MORE.
           
       WRITE-EMPLOYEE-RECORD.
           MOVE WS-NEW-EMP-ID TO EMP-ID.
           MOVE WS-NEW-EMP-NAME TO EMP-NAME.
           MOVE WS-NEW-DEPT TO EMP-DEPT.
           MOVE WS-NEW-POSITION TO EMP-POSITION.
           MOVE WS-NEW-SALARY TO EMP-SALARY.
           MOVE WS-NEW-HIRE-DATE TO EMP-HIRE-DATE.
           MOVE WS-NEW-STATUS TO EMP-STATUS.
           
           WRITE EMPLOYEE-RECORD
               INVALID KEY
                   DISPLAY 'ERROR: ÈáçË§áÁöÑÂì°Â∑•Á∑®Ëôü ' EMP-ID
               NOT INVALID KEY
                   DISPLAY 'INFO: Âì°Â∑•Ë®òÈåÑÊñ∞Â¢ûÊàêÂäü ' EMP-ID
           END-WRITE.
```

---

## üéØ Á¨¨‰∫îÁØÄÔºöÈö®Ê©üÊ™îÊ°àÂ≠òÂèñ

### 5.1 Èö®Ê©üËÆÄÂèñ

#### 5.1.1 ÊåâÈçµÂÄºÊü•Ë©¢

```cobol
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-SEARCH-KEY         PIC X(6).
       01  WS-CONTINUE-SEARCH    PIC X.
           88  CONTINUE-SEARCH         VALUE 'Y'.
           88  STOP-SEARCH             VALUE 'N'.
       
       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM OPEN-FILES
           PERFORM EMPLOYEE-INQUIRY
           PERFORM CLOSE-FILES
           STOP RUN.
           
       EMPLOYEE-INQUIRY.
           MOVE 'Y' TO WS-CONTINUE-SEARCH.
           PERFORM UNTIL STOP-SEARCH
               PERFORM GET-SEARCH-KEY
               IF CONTINUE-SEARCH
                   PERFORM SEARCH-EMPLOYEE
               END-IF
           END-PERFORM.
           
       GET-SEARCH-KEY.
           DISPLAY ' '
           DISPLAY '=== Âì°Â∑•Êü•Ë©¢Á≥ªÁµ± ==='.
           DISPLAY 'Ë´ãËº∏ÂÖ•Âì°Â∑•Á∑®Ëôü (Á©∫ÁôΩÁµêÊùü): '.
           ACCEPT WS-SEARCH-KEY.
           
           IF WS-SEARCH-KEY = SPACES
               SET STOP-SEARCH TO TRUE
           END-IF.
           
       SEARCH-EMPLOYEE.
           MOVE WS-SEARCH-KEY TO EMP-ID.
           
           READ EMPLOYEE-FILE
               KEY IS EMP-ID
               INVALID KEY
                   DISPLAY 'ERROR: Âì°Â∑•Á∑®Ëôü ' WS-SEARCH-KEY ' ‰∏çÂ≠òÂú®'
               NOT INVALID KEY
                   PERFORM DISPLAY-EMPLOYEE-INFO
           END-READ.
           
       DISPLAY-